/*
 * HotDocs Browser Interview Script - api.js
 * Version: 11.1.140121.1229
 * Copyright Â© HotDocs Limited 1992 - 2014. All rights reserved.
 */
define("api/popupwindow",["hdmain/jq"],function(a){var b=a.ui.dialog;return a.widget("hd.PopupWindow",b,{options:{autoOpen:!1,resizable:!0,draggable:!0,dialogClass:"hd-interview-base hd-popup",icon:"hd-rsrc",width:400,autoResize:!0},_setOption:function(a,c){switch(b.prototype._setOption.apply(this,arguments),a){case"title":this.titleIcon.attr({alt:c,title:c});break;case"icon":this.titleIcon.removeClass().addClass("hd-img "+c)}},_create:function(){b.prototype._create.apply(this,arguments);var c=this.uiDialogTitlebar;this.titleIcon=a("<div/>").attr("name","HDRsrcBtn").css({position:"absolute",left:"5px",visibility:"visible",margin:"0px"}).prependTo(c),c.children(".ui-dialog-title").css({display:"block",overflow:"hidden"}).appendTo(c),this.option(this.options)}}),a.hd.PopupWindow}),define("api",["hdmain/system","hdmain/jq","api/popupwindow"],function(a,b,c,d){function e(a){if(!a)return[];var b,c=a.split(":");for(b=0;b<c.length;b++)c[b]=parseInt(c[b],10);return c}var f=HOTDOC$;this.DEBUG===d&&(this.DEBUG=f.DEBUG);var g,h="string",i="number",j="boolean",k="object",l="function",m="",n=typeof RPC$===k,o="NOT_IMPLEMENTED",p={},q=[],r={},s=[],t={},u={};return u.Callbacks={OnHDFinish:function(){return typeof OnHDFinish==l?OnHDFinish.apply(arguments):o},OnHDStart:function(){typeof OnHDStart==l&&OnHDStart()},PreHDSubmit:function(){typeof PreHDSubmit==l&&PreHDSubmit.apply(arguments)}},u.PostAnswersToServer=function(a,b,c,d){if(typeof a==h&&a){typeof c==k&&c||(c=new Array),typeof d!=j&&(d=!0);var e;c.HDInfo=f.HDEngine.GetEncodedAnswers(),c.HDUtcOffset=(-(new Date).getTimezoneOffset()).toString(),e=u.PostAnswersToServer.caller==u._SaveAnswers?"SaveAnswers":u.PostAnswersToServer.caller==u.DocumentPreview?"DocumentPreview":"APICall",u._invokeHandler("PreHDSubmit",!0,!1,"FieldArray",c,"Context",e,"Callback",function(){u.PostToServer(a,c,d,b)})}},u.PostToServer=function(a,c,d,e){if(typeof a==h&&a&&typeof c==k&&c){typeof d!=j&&(d=!0);var g=b("#hdMainDiv");d&&(typeof e!=h&&(e=f.Lc.GetStr("ui_sresult")),g.HDInterview("ShowServerResponse",!0,!1,e)),g.HDInterview("Submit",a,c,"hdSvrRspFrm")}},u.AddCustomToolbarButton=function(a,c,e,g,j,k,n,o,p,s,t){var u,v=m;return typeof a==l?(typeof c!=h&&(c=null),typeof e!=h&&(e=m),typeof g!=h&&(g=m),typeof j!=h&&(j=m),typeof n!=h&&(n=m),typeof o!=h&&(o=m),typeof p!=h&&(p=m),typeof s!=i&&(s=0),v="hdtbbtn"+(q.length+1),u={ID:v,OnClick:a,IsActive:k,imgNorm:c?c:null,imgHot:e?e:null,imgAct:n?n:null,imgActHot:o?o:null,text:j,textAct:p,textStat:g,silverlightId:v,visible:!0,buttonIndex:s,textOnly:null==c||c===d||""==c,caption:typeof t==h?t:j},q.push(u),r[v]=u):b("#hdMainDiv").HDInterview("Error",this,f.Lc.GetStr("err_invprm_tb"),f.Lc.GetStr("err_invprm")),v},u.AddCustomNavButton=function(a,c,d,e,g,j,k,n,o){function p(a,b,c,d,e,f,g,h,i,j){this.id=null==a?"hdnbbtn"+(s.length+1):a,this.silverlightId=this.id,this.visible=!0,this.link=null==b?this.id:b,this.cell=e,this.separator=f,this.buttonType=d,this.customCaption=g,this.customImage=h,this.customTooltip=i,this.buttonIndex=j,s.push(this),t[this.id]=this}var q,r=m;return typeof a==l?(typeof d!=i&&(d=f.Dialog.HDNavBtnType.TextOnly),typeof j!=h&&(j=m),typeof e!=h&&(e=m),typeof g!=h&&(g=m),typeof k!=i&&(k=2),typeof n!=i&&(n=-1),typeof o!=i&&(o=0),q=new p(null,null,0,d,k,o,e,j,g,n),q.OnClick=a,typeof c==l&&(q.IsEnabled=c),r=q.id):b("#hdMainDiv").HDInterview("Error",this,f.Lc.GetStr("err_invprm_nb"),f.Lc.GetStr("err_invprm")),r},u.InvokeButton=function(a){if(typeof a==h){var c,d=f.HDEngine;if("HDReturnToInterview"==a)b("#hdMainDiv").HDInterview("ShowServerResponse",!1);else{if("HDNavigationBar"==a||"HDToolBar"==a)return;if(c=t[a],null!=c)return d.InvokeButton(a),void 0;if(c=r[a],null!=c)return d.InvokeButton(c.silverlightId),void 0;d.InvokeButton(a)}}},u.SetButtonVisibility=function(a,b){if(typeof a==h){typeof b!=j&&(b=!0);var c,d=f.HDEngine;switch(a){case"HDNavigationBar":typeof d.NavigationBarVisible==j?d.NavigationBarVisible=b:d.NavigationBarVisible(b);break;case"HDToolBar":typeof d.ToolBarVisible==j?d.ToolBarVisible=b:d.ToolBarVisible(b);break;default:if(c=t[a],null!=c)return c.visible=b,d.SetButtonVisible(c.id,b),void 0;if(c=r[a],null!=c)return c.visible=b,d.SetButtonVisible(c.silverlightId,b),void 0;d.SetButtonVisible(a,b)}}},u.SetToolbarButtonImage=function(a,c,d,e,g){var i,j=f.HDEngine;if(typeof a==h&&typeof c==h&&c){if(typeof d!=h&&(d=m),typeof e!=h&&(e=m),typeof g!=h&&(g=m),"HDNavigationBar"==a||"HDToolBar"==a)return;if(i=r[a],null!=i)return i.imgNorm=c,i.imgHot=d?d:null,i.imgAct=e?e:null,i.imgActHot=g?g:null,j.SetToolbarButtonImage(i.silverlightId,i.imgNorm,i.imgHot,i.imgAct,i.imgActHot),void 0;j.SetToolbarButtonImage(a,c,d,e,g)}else b("#hdMainDiv").HDInterview("Error",this,f.Lc.GetStr("err_invprm_img"),f.Lc.GetStr("err_invprm"))},u.SetNavbarButtonImage=function(a,b){typeof a==h&&typeof b==h&&f.HDEngine.SetNavigationbarButtonImage(a,b)},u.ScreenRefresh=function(){var a=f.HDEngine;a.InBulkAnswerUpdate()&&a.EndBulkAnswerUpdate()},u.SetAnswer=function(a,b,c){var g,j=f.HDEngine;if(j.InBulkAnswerUpdate()||j.BeginBulkAnswerUpdate(),g=j.GetValType(a)){if(null===b||typeof b==h&&b==m)b=null;else switch(g){case"TX":typeof b!=h&&(b=b.toString());break;case"DA":if("date"==typeof b?b=new Date(b):typeof b==h&&(b=f.Lc.ParseDate(b)),typeof b!=k||null===b||b.getDate===d)return;b=new Date(b.valueOf());break;case"TF":typeof b==h?b="TRUE"==b.toUpperCase():typeof b==i&&(b=0!=b);break;case"MC":b=typeof b==h?b.replace(/\|/g,""):b.toString()}j.SetValue(g,a,e(c),b)}},u.GetAnswer=function(a,b){var c,d=f.HDEngine,g=d.GetValType(a);if(g)return c=d.GetValue(a,e(b)),c&&"MC"==g&&(c=typeof c===h?c.replace(/\2/g,"|"):c.join("|")),c},u.GetAnswerIterator=function(){var a;return a=f.HDEngine.GetCurrentRepeatIndex(),a===m?0:(a=a.split(":"),1+parseInt(a[a.length-1]))},u.GetAnswerRepeatIndex=function(){var a;for(a=f.HDEngine.GetCurrentRepeatIndex(),a===m&&(a="0"),a=a.split(":");a.length<4;)a.push("-1");return a.join(":")},u.GetXMLAnswers=function(){return f.HDEngine.GetXMLAnswers(!1)},u.GetInterviewBookmark=function(){return f.HDEngine.GetBookmark()},u.GetProgress=function(){return b.parseJSON(f.HDEngine.GetProgress())},u.GotoInterviewBookmark=function(a){return f.HDEngine.GotoBookmark(a)},u.RegisterHandler=function(a,b){var c=p[a];c||(c=[],p[a]=c),c.push(b)},u.UnregisterHandler=function(a,b){function c(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1}var d,e=p[a];e&&(d=c(e,b),d>=0&&e.splice(d,1))},u.GetAnswerSummary=function(){return f.HDEngine.GetAnswerSummary()},u.DocumentPreview=function(){var a=new Array;"string"==typeof f.DPState?a.StateString=f.DPState:(a.TemplateState=HDTemplateState,a.TempInterviewUrl=b("#hdMainDiv").HDInterview("option","TplImgPath"),a.TempInterviewState=typeof HDTplImgState==h?HDTplImgState:m,a.InlineImages=f.g_allowDataURIs.toString()),u.PostAnswersToServer(HDDocPreviewUrl,f.Lc.GetStr("tb_dp"),a)},u.SetTemplateTitle=function(a){var b=f.HDEngine;typeof a==h&&(typeof b.TemplateTitle==l?b.TemplateTitle(a):b.TemplateTitle=a)},u.EncodeString=function(a,b,c){return f.HDEngine.EncodeString(a,b,typeof c==j?c:!1)},u.ServerResponseVisible=function(){var a=b("#hdServerResponse");return a.length>0&&"hidden"!=a.css("visibility")&&"none"!=a.css("display")},u.InPopupInterview=function(){return f.HDEngine.InPopupInterview()},u.ClosePopupInterview=function(){f.HDEngine.ClosePopupInterview()},u.ShowMessageBox=function(a,c,e){c===d&&(c=f.Lc.GetStr("ui_hd")),e===d&&(e="hd-alert"),b("<div/>").html(a).PopupWindow({modal:!0,title:c,buttons:{OK:function(){b(this).PopupWindow("close").PopupWindow("destroy").remove()}},icon:e,maxHeight:.8*b("#hdMainDiv").height()}).PopupWindow("open")},u._enumCustTBBtns=function(a){var b,c,d;for(b=0;b<q.length;b++)c=q[b],d=a.RegisterToolbarButton(c.imgNorm,c.imgHot,c.textStat,c.text,typeof c.IsActive==l,c.imgAct,c.imgActHot,c.textAct,c.buttonIndex,c.caption),c.silverlightId=d,r[d]=c,c.visible||u.SetButtonVisibility(c.ID,c.visible)},u._clickCustTBBtn=function(a){var b=r[a];b&&b.OnClick(b.ID)},u._custTBBtnIsActive=function(a,b){var c=r[a];c&&typeof c.IsActive==l?n?c.IsActive(c.ID,b):b(c.IsActive(c.ID)):b(!1)},u._enumCustNBBtns=function(a){var b,c,d;for(b=0;b<s.length;b++)c=s[b],d=a.RegisterNavigationbarButton(c.buttonType,typeof c.IsEnabled==l,c.customCaption,c.customTooltip,c.customImage,c.cell,c.buttonIndex,c.separator,c.id),c.silverlightId=d,t[d]=c,c.visible||u.SetButtonVisibility(c.id,c.visible)},u._clickCustNBBtn=function(a){var b=t[a];b&&b.OnClick(b.id)},u._custNBBtnIsEnabled=function(a,b){var c=t[a];c&&typeof c.IsEnabled==l?n?c.IsEnabled(c.id,b):b(c.IsEnabled(c.id)):b(!0)},u._invokeHandler=function(a,c,e){function g(a){if(null==a||typeof a!=k)return a;var b,c=new a.constructor;for(b in a)c[b]=a[b];return c}function i(a){if(null==a||typeof a!=k)return a;var b,c=new a.constructor;for(b in a)c[b]=i(a[b]);return c}var l,q,r,s,t,v,w,x={},y=!1,z=m,A=p[a];e&&(c=!0);try{for(c&&"OnHDStart"==a?u.Callbacks.OnHDStart():"OnHDNavigated"==a&&(f.g_navEventFired=!0),l=3;l<arguments.length-1;l+=2)if("Callback"==arguments[l]){v=arguments[l+1];break}if(v==d&&(v=function(){}),A){for(e&&(x.Cancel=!1,x.CancelMessage=m),l=3;l<arguments.length-1;l+=2)"Callback"!=arguments[l]&&(x[arguments[l]]=arguments[l+1]);if(q=x,c){for(w=b.Deferred().progress(function(a){function b(){e&&x.Cancel&&(y=!0,x.CancelMessage&&(z=x.CancelMessage)),a==A.length-1&&w.resolveWith(this)}x=g(q),n?A[a](x,b):(A[a](x),b())}).done(function(){v(e?y:!1,z)}),l=0;l<A.length;l++)w.notifyWith(this,[l]);return}window.setTimeout(function(){for(l=0;l<A.length;l++)A[l](i(q))},0)}if(c&&"PreHDSubmit"==a)u.Callbacks.PreHDSubmit(arguments[4],arguments[6]);else if(c&&e&&"OnHDFinish"==a&&(r=u.Callbacks.OnHDFinish(),r!==o))return v(typeof r==j&&!r,z),void 0}catch(B){s=f.Lc.GetStr,t=s("err_handler",a),B&&(B.message?t+="  "+B.message:typeof B==h&&(t+="  "+B)),alert(t+"\n\n"+s("err_siteadm"))}v(y,z)},u._assertSvrRspHidden=function(){var a=u.ServerResponseVisible();return a&&HDAPI.ShowMessageBox(f.Lc.GetStr("err_mustret")),!a},u._SaveAnswers=function(){var a=new Array;a.HDDlgAt=m,u.PostAnswersToServer(b("#hdMainDiv").HDInterview("option","saUrl"),f.Lc.GetStr("tb_sv"),a)},u._DoWebLinkAction=function(a){return typeof a==h?(a.indexOf("%")>=0&&(a=unescape(a)),window.eval(a)):void 0},u._OpenResourceWindow=function(c,e){typeof c!=h&&(c=m),typeof e!=h&&(e=m);var i=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i,j=i.test(navigator.userAgent)||i.test(navigator.platform);j&&f.Dialog.InterviewStack.CurrentInterview()._dialogControl.DialogControl("option","ResourcePaneVisibility")==a.Windows.Visibility.Visible?f.Dialog.InterviewStack.CurrentInterview()._dialogControl.data("hd-DialogControl").ResourcePane.HtmlHostControl("SetText",c).focus():(g===d&&(g=b("<div/>").appendTo("#hdMainDiv").PopupWindow(),g.parent().addClass("hd-popup-resource")),g.html(c).PopupWindow({title:e,modal:j,maxHeight:.8*b("#hdMainDiv").height()}).PopupWindow("open"))},u._showInterviewHelp=function(){function c(a){b("<h2/>").text(j.GetStr(a)).appendTo(i)}function d(a){return'<div class="hd-img '+a+'" style="position:relative; float:none; display:inline-block; visibility:visible"/>'}function e(a){var c=j.GetStr(a);arguments.length>0&&(arguments[0]=c,c=k.apply(this,arguments)),b('<div class="hd-help"/>').html(c).appendTo(i)}function g(a){var c,d,e,f,g=b('<table class="hd-help-table"/>').appendTo(i),h=b("<thead/>").appendTo(g),l=b("<tr/>").appendTo(h);for(b('<th class="hd-help-col-one">'+j.GetStr("hlp_to")+"</th>").appendTo(l),b("<th>"+j.GetStr("hlp_do")+"</th>").appendTo(l),c=0;c<a.length;c++){d=b("<tr/>").appendTo(g);for(e in a[c])f=a[c][e]?a[c][e]:[],f.splice(0,0,j.GetStr("hlp_"+e)),b("<td/>").html(k.apply(this,f)).appendTo(d)}}function h(a){var c,d=b('<ul class="hd-help-ul"/>').appendTo(i);for(c=0;c<a.length;c++)b(a[c]).appendTo(d)}var i=b("<div/>"),j=f.Lc,k=a.String.Format,l='<li><div class="hd-dlg-{0} hd-img{1}"/>{2}</li>';e("hlp_intro"),e("hlp_intro2"),c("ui_io"),e("hlp_io_ovw"),e("hlp_io_tbl"),h([k(l,"u","",j.GetStr("hlp_io_du")),k(l,"n","",j.GetStr("hlp_io_dn")),k(l,"p","",j.GetStr("hlp_io_dp")),k(l,"a","",j.GetStr("hlp_io_da")),k(l,"r","",j.GetStr("hlp_io_dr")),k(l,"u","-g",j.GetStr("hlp_io_dug"))]),e("hlp_io_loc"),g([{io_widT:[],io_widD:[]},{io_clsT:[],io_clsD:[d("hd-closex"),d("hdtb-icon hdtb-btnol")]},{io_vdlT:[],io_vdlD:[d("hdtb-icon hdtb-btnol")]}]),c("hlp_dp"),e("hlp_dp_ovw"),e("hlp_dp_tbl"),g([{dp_txtT:null,dp_txtD:null},{dp_chkT:null,dp_chkD:null},{dp_calT:null,dp_calD:[d("hd-cal-calendar")]},{dp_rptT:null,dp_rptD:[d("hd-adit")]},{dp_sprT:null,dp_sprD:[j.GetStr("hdmnuEditRow"),j.GetStr("hdmnuInsRow"),j.GetStr("hdmnuDelRow")]},{dp_nstT:null,dp_nstD:[d("hd-nav-Next")]},{dp_nxdT:null,dp_nxdD:[d("hd-nav-Next"),d("hd-nav-Prev")]},{dp_nxuT:null,dp_nxuD:[d("hd-nav-NextU"),d("hd-nav-PrevU")]},{dp_frsT:null,dp_frsD:[d("hd-nav-First"),d("hd-nav-Last")]},{dp_finT:null,dp_finD:[d("hd-nav-Finish")]}]),c("hlp_rp"),e("hlp_rp_intro"),e("hlp_rp_how",d("hdtb-icon hdtb-btnrs"),d("hd-rsrc")),e("hlp_rp_note"),this._ShowModalResponse(i.html(),j.GetStr("ui_help"),!0)},u._ShowModalResponse=function(a,c,d){typeof a!=h&&(a=m),typeof c!=h&&(c=m),typeof d!=j&&(d=!1);var e="hdModalResponse",f=b("#"+e).remove(),g=b("#hdServerResponse"),i=b("#hdWrapper");f=b("<div/>").attr("id",e).css({position:"absolute",top:"0px",overflow:"auto"}).html(a).appendTo(g),b("#hdMainDiv").HDInterview("ShowServerResponse",!0,d,c),g.width(i.width()).height(i.height())},u._getAPIHelp=function(){function a(a,c,d){var f,g=b(a.toString()),h={},i=g.getElementsByTagName("param");for(f=0;f<i.length;f++)h[i[f].getAttribute("name")]=e(i[f]);return{Type:d,Title:c,Summary:e(g.getElementsByTagName("summary")),Remarks:e(g.getElementsByTagName("remarks")),Example:e(g.getElementsByTagName("example")),Return:e(g.getElementsByTagName("returns")),Parameters:h}}function b(a){var b,e=a.split("\r\n");for(b=0;b<e.length;b++)e[b]=d(e[b]),e[b]=0!=e[b].indexOf("///")||e[b].indexOf("JS_PUBLIC_API")>0?"":d(e[b].substr(3));return c("<doc>"+e.join(" ")+"</doc>").childNodes[0]}function c(a){return this.DOMParser?(parser=new DOMParser,xmlDoc=parser.parseFromString(a,"text/xml")):(xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async=!1,xmlDoc.loadXML(a)),xmlDoc}function d(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function e(a){var b,c,d="";if(0!=a.length)for(b=a.length?a[0].childNodes:a.childNodes,c=0;c<b.length;c++)"undefined"!=typeof XMLSerializer?d+=(new XMLSerializer).serializeToString(b[c]):"undefined"!=typeof b[c].xml&&(d+=b[c].xml);return d}var f,g,h={};for(f in u)if(0!=f.indexOf("_"))switch(f){case"Callbacks":case"InterviewOptions":for(g in u[f])h[u[f][g]()]=a(u[f][g],g,"Callbacks"==f?1:2);break;default:h[f]=a(u[f],f,0)}return h},u._export=function(a){a.HDPostAnswersToServer=u.PostAnswersToServer,a.HDPostToServer=u.PostToServer,a.HDAddCustomToolbarButton=u.AddCustomToolbarButton,a.HDAddCustomNavButton=u.AddCustomNavButton,a.HDInvokeButton=u.InvokeButton,a.HDSetButtonVisibility=u.SetButtonVisibility,a.HDSetToolbarButtonImage=u.SetToolbarButtonImage,a.HDSetNavButtonImage=u.SetNavbarButtonImage,a.HDScreenRefresh=u.ScreenRefresh,a.HDAnsSetVal=u.SetAnswer,a.HDAnsGetVal=u.GetAnswer,a.HDAnsGetIter=u.GetAnswerIterator,a.HDAnsGetRptNdx=u.GetAnswerRepeatIndex,a.HDGetXMLAnswers=u.GetXMLAnswers,a.HDGetInterviewBookmark=u.GetInterviewBookmark,a.HDGotoInterviewBookmark=u.GotoInterviewBookmark,a.HDRegisterHandler=u.RegisterHandler,a.HDUnregisterHandler=u.UnregisterHandler,a.HDGetAnswerSummary=u.GetAnswerSummary,a.DoHDDocumentPreview=u.DocumentPreview,a.HDSetTemplateTitle=u.SetTemplateTitle,a.HDEncodeString=u.EncodeString,a.HDSubmitAns=function(){f.HDEngine.Finish()},a.HDServerResponseVisible=u.ServerResponseVisible},this.HDAPI=u,HDAPI});