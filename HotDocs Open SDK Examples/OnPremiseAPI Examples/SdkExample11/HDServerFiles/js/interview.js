/*
 * HotDocs Browser Interview Script - interview.js
 * Version: 11.1.140121.1229
 * Copyright Â© HotDocs Limited 1992 - 2014. All rights reserved.
 */
define("system/exception",[],function(){function a(a,b){this.message=a,this.InnerException=b}return a}),define("system/exception/systemexception",["hdmain/system","system/exception"],function(a,b,c){function d(){d.baseConstructor.apply(this,arguments)}var e=HOTDOC$;return this.DEBUG===c&&(this.DEBUG=e.DEBUG),a.ExtendClass(d,b),d}),define("system/exception/argumentexception",["hdmain/system","system/exception/systemexception"],function(a,b,c){function d(){d.baseConstructor.apply(this,arguments)}var e=HOTDOC$;return this.DEBUG===c&&(this.DEBUG=e.DEBUG),a.ExtendClass(d,b),d}),define("dialog/customnavigationbarbuttondef",["hdmain/system","system/exception/argumentexception"],function(a,b){function c(c,e,f,g,h,i,j,k,l){if(h.indexOf("/")<0&&h.indexOf("\\")<0)throw new b(d.Lc.GetStr("err_nopath"),"imageName");this.ID=a.Guid.NewGuid(),this.ButtonType=c,this.HasEnabledState=e,this.ButtonText=f,this.Tooltip=g,this.ImageName=h,this.Cell=i,this.ButtonIndex=j,this.SeparatorPos=k,this.Name=l}var d=HOTDOC$;return c}),define("dialog/customnavigationbar",[],{s_customNavigationbarButtonDefs:[],AddButtonDefinition:function(a){this.s_customNavigationbarButtonDefs.push(a)},ButtonDefinitions:function(){return this.s_customNavigationbarButtonDefs}}),define("system/jq.menu/basemenucontrol",["hdmain/jq"],function(a){var b="hd-menu";return a.widget("hd.BaseMenuControl",{_create:function(){this.element.addClass(b+"-base").css("width","200px"),a("<div/>").addClass(b+"-iconbkgrd").appendTo(this.element),this.item=a("<div/>").addClass(b+"-item").css("width","98%").appendTo(this.element),this.icon=a("<div/>").addClass(b+"-icon").appendTo(this.item),this.caption=a("<div/>").addClass(b+"-caption").appendTo(this.item)}}),a.hd.BaseMenuControl}),define("system/jq.menu/menuitem",["hdmain/jq","system/jq.menu/basemenucontrol"],function(a,b){var c="hd-menu";return a.widget("hd.MenuItem",{_create:function(){b.prototype._create.apply(this,arguments),this.element.css("cursor","default"),this.option(this.options)},_setOption:function(b,d){switch(a.Widget.prototype._setOption.apply(this,arguments),b){case"Label":this.caption.html(d.replace(/ +/g,"&nbsp;"));break;case"IconImageSource":this.icon.addClass(d);break;case"Tag":this.element.attr("tag",d);break;case"IsEnabled":d?this.element.on("click",a.proxy(function(){this.element.parent().trigger("ItemSelected",parseInt(this.element.attr("tag")))},this)).hover(a.proxy(function(){this.item.toggleClass(c+"-hilite")},this)):this.caption.addClass(c+"-disabled")}}}),a.hd.MenuItem}),define("system/jquery.hd.popup",["hdmain/jq"],function(a){return a.widget("hd.Popup",{_create:function(){this._isOpen=!1,this.element.addClass("hd-popup-elem").hide().appendTo("#hdMainDiv")},open:function(){var a,b,c=this.options,d=c.anchor;this._isOpen=!0,this.element.show(),"function"==typeof c.open&&c.open(this),d&&(a="t"==c.anchorPos?d.offset().top-this.element.height():d.offset().top+d.height(),b=d.offset().left-this.element.width()+d.outerWidth(),this.element.css({top:a,left:b}))},close:function(){this._isOpen=!1,this.element.hide(),"function"==typeof this.options.close&&this.options.close(this)},toggle:function(){this._isOpen?this.close():this.open()},IsOpen:function(){return this._isOpen},Empty:function(){}}),a.hd.Popup}),define("system/jq.menu/menu",["hdmain/jq","system/jquery.hd.popup"],function(a){var b="hd-menu";return a.widget("hd.Menu",{_create:function(){this.element.addClass(b).on("mouseleave",function(){a("."+b).parent().Popup("close")})}}),a.hd.Menu}),define("system/exception/argumentnullexception",["hdmain/system","system/exception/argumentexception"],function(a,b,c){function d(){d.baseConstructor.apply(this,arguments)}var e=HOTDOC$;return this.DEBUG===c&&(this.DEBUG=e.DEBUG),a.ExtendClass(d,b),d}),define("interview/sidebar",["hdmain/jq"],function(a,b){var c=a.proxy;return a.widget("hd.SideBar",{options:{icon:"hd-blank",side:"left",tip:""},_create:function(){this.container=a("<td/>").addClass("hd-sidebar-cell");var d=a("<div/>").appendTo(this.container);this.floater=a("<div/>").appendTo(d).addClass("hd-sidebar").on("swipe",c(function(a,c){("left"==this.options.side?c:-c)<0&&this.Slide(a,b,!1)},this)).click(c(this.Slide,this)),this.element.children().appendTo(this.floater),this.element.addClass("hd-collapse-bar").click(c(this.Slide,this)),this.icon=a("<div/>").appendTo(this.element),this.title=a("<div><span/></div>").addClass("hd-rotate90").appendTo(this.element),this.option(this.options)},_setOption:function(b,c){switch(b){case"side":this.container["insert"+("right"==c?"Before":"After")](this.element);break;case"icon":this.icon.removeClass().addClass("hd-img "+c);break;case"tip":this.element.attr("title","string"==typeof c?c:c[0]);break;case"title":this.title.children("span").text(c)}a.Widget.prototype._setOption.apply(this,arguments)},Show:function(){this.floater.hide(),this.container.show(),this.element.show(),this.floater.css(this.options.side,"-"+this.floater.outerWidth()+"px").show()},Hide:function(){this.element.hide(),this.container.hide()},Slide:function(d,e,f){var g=this.options.side,h={},i=this.options.tip;f==b&&(f=parseInt(this.floater.css(g))<0),"function"==typeof i.push&&i.length>1&&this.element.attr("title",f?i[1]:i[0]),a(document.body).off(".toClose"+g),f&&a(document.body).on("click.toClose"+g,c(function(c){c.target!=this.element[0]&&!a.contains(this.element[0],c.target)&&(this.Slide.call(this,c,b,!1),this.element.off(".toClose"))},this)),h[g]=f?"0px":"-"+this.floater.outerWidth()+"px",this.floater.animate(h,e)}}),a.hd.SideBar}),define("system/jq.treeview/basetreeviewcontrol",["hdmain/jq"],function(a){return a.widget("hd.BaseTreeViewControl",{options:{IsEnabled:!0,DisabledOpacity:.7},_create:function(){this.option(this.options)},_setOption:function(b,c){switch(a.Widget.prototype._setOption.apply(this,arguments),b){case"IsEnabled":this.OnEnabledChanged(c)}},UpdateVisualState:function(){},OnApplyTemplate:function(){},OnEnabledChanged:function(a){this.IsTabStop=a,this.UpdateVisualState()}}),a.hd.BaseTreeViewControl}),define("system/jq.treeview/expand",["hdmain/jq","./basetreeviewcontrol","hdmain/system"],function(a,b,c){var d=a.proxy,e="hd-img hd-lin-b",f="hd-img hd-mns-b",g="hd-img hd-pls-b";return a.widget("hd.Expand",b,{options:{width:11,height:11},_create:function(){this.element.mousedown(d(this.Expand_MouseDown,this))},_setOption:function(b){switch(a.Widget.prototype._setOption.apply(this,arguments),b){case"IsExpanded":this.UpdateVisualState()}},UpdateVisualState:function(){this.element.removeClass().addClass(this.options.Visibility==c.Windows.Visibility.Visible?this.options.IsExpanded?f:g:e)},OnApplyTemplate:function(){},Expand_MouseDown:function(a){1==a.which&&this.options.IsEnabled&&this._setOption("IsExpanded",!this.options.IsExpanded)}}),a.hd.Expand}),define("system/jq.treeview/node",["hdmain/jq","./basetreeviewcontrol","./expand","hdmain/system"],function(a,b,c,d){function e(){0==this._childrenToLoad&&this.element.trigger("NodeExpanded",new n.TreeEventArgs(this.options.ID))}function f(){var a=this.options,b=a[q]&&a.IconExpanded.length>0?a.IconExpanded:a.Icon,c=a[q]&&null!=a.IconExpandedContent?a.IconExpandedContent:a.IconContent;b.length>0?this.ElementIcon.removeClass().addClass(b):null!=c&&this.ElementIcon.removeClass().addClass(c)}function g(a){null!=this.element&&(a?this.ElementChildren.show():this.ElementChildren.hide("slide"))}function h(){var a=new n.TreeEventArgs(this.options.ID);this.element.trigger("PopulateChildren",a),this.SyncChildren(),this._setOption("ChildrenLoaded",!0)}function i(){if(this.element.prevAll("li").removeClass().addClass(w),this.element.nextAll("li").length>0)this.element.removeClass().addClass(w);else{this.element.removeClass();var b=this.element.children("ins").attr("class");"string"==typeof b&&(b+=" ",b=b.replace(/-m /,"-b "),this.element.children("ins").attr("class",b))}this.element.children("ul").children("li").each(function(){i.call(d.Cast(a(this),p))})}function j(){i.call(this)}function k(){this.SyncChildren()}function l(){var a=this.options;a[r]&&(a[q]?this.Collapse():this.Expand())}function m(){this._childrenToLoad--,this._childrenToLoad<=0&&(this._childrenToLoad=0,e.call(this))}var n=HOTDOC$,o=a.proxy,p="Node",q="IsExpanded",r="IsEnabled",s="HasChildren",t=d.Windows.Visibility,u="NodeChildTemplateApplied",v="mousedown",w="hd-lin-s";return a.widget("hd.Node",b,{options:{IsExpanded:!1,HasChildren:!1,IsEnabled:!0,Icon:"",IconExpanded:"",IsLabel:!1,TemplateApplied:!1,ChildrenLoaded:!1,IsBusy:!1},HasChildren:function(){return this.Nodes.Count()>0?!0:this.options[s]},_create:function(){this.ElementExpand=a('<ins class="hd-img "></ins>').Expand().appendTo(this.element).on("click",o(l,this)),this.element.is("div")&&this.ElementExpand.hide(),this.element.is("li")&&(this.element.addClass(w),this.Line=this.ElementExpand,this.Link=a("<a/>").appendTo(this.element),this.ElementIcon=a("<ins/>").appendTo(this.Link),this.ElementText=a("<span class='hd-ol-entry' />").appendTo(this.Link)),this.Nodes=a.ObservableCollection().OnCollectionChanged(o(k,this)),this.ElementChildren=a("<ul>").appendTo(this.element),this.element.is("li")&&this.ElementChildren.hide(),this.element.on("ApplyTemplate",o(this.OnApplyTemplate,this)).on("SizeChanged",o(j,this)),this.option(this.options)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments);var d=this.options;switch(b){case s:this.element.children("ins").removeClass().addClass("hd-img hd-lin-m"),c||(d.ChildrenLoaded=!1),this.UpdateVisualState();break;case r:this.element.find(".hd-ol-entry").toggleClass("hd-ol-entry-d",!c);break;case"IsSelected":this.UpdateVisualState();break;case"IconContent":d.Icon=c,this.ElementIcon.removeClass().addClass(c),this.UpdateVisualState();break;case"Title":this.UpdateVisualState()}},Expand:function(){var a=this.options,b=new n.TreeEventArgs(a.ID);this!=this.Base&&!a[q]&&this.HasChildren()&&(b.Source=this,this.element.trigger("NodeExpand",b),b.Cancel||(this._setOption(q,!0),a.ChildrenLoaded?e.call(this):h.call(this),g.call(this,!0),this.element.trigger("NodeStateChange",{}),f.call(this),this.UpdateVisualState()))},Collapse:function(){this!=this.Base&&(this._setOption(q,!1),null!=this.element&&(g.call(this,!1),this.HasChildren()&&(this.element.trigger("NodeClosed",new n.TreeEventArgs),this.element.trigger("NodeStateChange",{}))),f.call(this),this.UpdateVisualState())},Get:function(a){var b,c,d=null;for(b=0;b<this.Nodes.Count();b++){if(c=this.Nodes.get(b),c.InterviewTreeNode("option","ID")==a){d=c;break}if(d=c.InterviewTreeNode("Get",a),null!=d)break}return d},SyncChildren:function(){var a,b,c,e=this.Nodes.Count();for(a=0;e>a;a++)c=this.Nodes.get(a),c.Base=this.Base,c.ParentNode=this;for(0==this.HasChildren()&&e>0?this._setOption(s,!0):0==e&&this._setOption(s,!1),this.ElementChildren.children().detach(),this._childrenToLoad=0,a=0;e>a;a++)b=d.Cast(this.Nodes.get(a),"Node"),b.options.TemplateApplied||(b.element.off(u,m).on(u,o(m,this)),this._childrenToLoad++),b.element.appendTo(this.ElementChildren),b.options.TemplateApplied||b.element.trigger("ApplyTemplate").trigger("SizeChanged");this.UpdateVisualState(),this.UpdateVisuals()},UpdateVisualState:function(){var a=this.options;a.IsBusy||this.ElementExpand.Expand({Visibility:this.HasChildren()?t.Visible:t.Collapsed}),this.HasChildren()&&this.ElementExpand.Expand({IsExpanded:a[q]}).css("cursor",a[r]?"pointer":"default"),(a.Icon.length>0||null!=a.IconContent)&&(this.ElementIcon.css("cursor",a[r]&&!a.IsLabel?"pointer":"default"),f.call(this)),null!=a.Title&&this.ElementText.text(a.Title)},UpdateVisuals:function(){i.call(this)},OnApplyTemplate:function(){var b=this.element,c=this.options;b.children("a").off(v).on(v,b,o(function(b){a(b.data).closest("div").trigger("NodeClick",b.data)},this)),this.UpdateVisualState(),c.TemplateApplied=!0,this.element.trigger(u),c[q]&&(f.call(this),this.UpdateVisualState())}}),a.hd.Node}),define("system/jq.treeview/tree",["hdmain/jq","./node","hdmain/system"],function(a,b,c,d){var e=HOTDOC$;return a.widget("hd.Tree",b,{_create:function(){b.prototype._create.apply(this),this._selected=null,this.element.on("PopulateChildren",a.proxy(this.RaisePopulate,this))},_setOption:function(a,c){switch(b.prototype._setOption.apply(this,arguments),a){case"NodeClick":this.element.on(a,c)}},Selected:function(a){return a===d?this._selected:(this.ClearSelected(),this._selected=a,null!=this._selected&&(c.Cast(this._selected,"Node")._setOption("IsSelected",!0),this._selected.find(".hd-ol-entry:first").attr("id","hdOutlineCurrent").scrollintoview({direction:"vertical"})),void 0)},ClearSelected:function(){this.ElementChildren.find("#hdOutlineCurrent").removeAttr("id")},RaisePopulate:function(a,b){this.element.trigger("Populate",a,b)}}),e.TreeEventArgs=function(a){a===d?(this.ID="",this.Copy=!1):(this.ID=a,this.Source=null,this.Target=null,this.Copy=!1)},a.hd.Tree}),define("dialog/stringformatter",["hdmain/system"],function(a){function b(a,b){this._text=a,this._textWrapping=b}return a.ExtendClass(b,null,{PreParse:function(){},PostParse:function(){},WriteText:function(a,b){this._text.Append(b)},WriteLineBreak:function(){this._text.Append(this._textWrapping==a.Windows.TextWrapping.NoWrap?" ":"\n")},WriteWebLink:function(a,b,c){this._text.Append(c)}}),b}),define("engine/stringparsersource",["hdmain/system"],function(a){function b(a){this._text=a}return a.ExtendClass(b,null,{SourceString:function(){return this._text}}),b}),define("engine/interviewnodeoutlinefontflags",[],{None:0,Bold:1,Italic:2,Underline:4}),define("engine/answeredstatus",[],{Unanswered:0,PartiallyAnswered:1,Answered:2}),define("engine/interviewnodetype",[],{Root:0,Dialog:1,DefaultDialog:2,Repeat:3,Iteration:4}),define("engine/dialogupdateflags",[],function(){var a={None:0,UserAnswer:1,ScriptAnswer:2,RequiredAnswer:4,RepeatAnswer:8,Gray:16,Hidden:32,Required:64,set:128,AddClear:256,Prompt:512,Title:1024,NodeTitle:2048,ChildCount:4096,NodeChildCount:8192,NewlyAdded:16384,NodeNewlyAdded:32768,AnsweredStatus:65536,NodeAnsStatus:131072,NodeRequired:262144,NodeEnabled:524288,Progress:1048576,AddButtonRefresh:2097152,NodeError:4194304,HasError:8388608,All:2147483647};return a.AnswerRelated=a.UserAnswer|a.ScriptAnswer|a.RequiredAnswer|a.RepeatAnswer|a.HasError,a.StatusRelated=a.NodeAnsStatus|a.NodeRequired|a.NodeError|a.NodeEnabled|a.Progress,a.OutlineRelated=a.StatusRelated|a.NodeTitle|a.NodeChildCount,a.DialogContentRelated=a.ScriptAnswer|a.RequiredAnswer|a.RepeatAnswer|a.Gray|a.Hidden|a.Required|a.set|a.AddClear|a.Prompt,a.DialogRelated=a.DialogContentRelated|a.Title|a.AddButtonRefresh|a.HasError,a.SinglePageRelated=a.DialogRelated|a.ChildCount,a.AllOutlineRelated=a.OutlineRelated|a.NodeNewlyAdded,a.AllDialogRelated=a.AnswerRelated|a.DialogRelated|a.ChildCount|a.NewlyAdded|a.AnsweredStatus,a}),define("interview/outlinecontrol",["hdmain/jq","system/jq.treeview/node","system/jq.treeview/tree","hdmain/system","dialog/stringformatter","engine/stringparsersource","engine/interviewnodeoutlinefontflags","engine/answeredstatus","engine/interviewnodetype","engine/dialogupdateflags"],function(a,b,c,d,e,f,g,h,i,j,k){var l=HOTDOC$,m=a.proxy,n="InterviewTreeNode";return this.DEBUG===k&&(this.DEBUG=l.DEBUG),a.widget("hd.InterviewTreeNode",b,{_create:function(){b.prototype._create.apply(this)},_setOption:function(a,c){switch(a){case"OutlineFontFlags":c!=this.options.OutlineFontFlags&&(null!=this.ElementText&&this.UpdateElementText(this.ElementText),null!=this.ElementSelectedText&&this.UpdateElementText(this.ElementSelectedText))}b.prototype._setOption.apply(this,arguments)},OnApplyTemplate:function(){b.prototype.OnApplyTemplate.apply(this),this.options.OutlineFontFlags!=g.None&&this.UpdateElementText(this.ElementText)},UpdateElementText:function(a){var b=this.options.OutlineFontFlags;a.css({"font-style":(b&g.Italic)==g.Italic?"italic":"normal","font-weight":(b&g.Bold)==g.Bold?"bold":"normal","text-decoration":(b&g.Underline)==g.Underline?"underline":"none"})}}),a.widget("hd.OutlineControl",{_create:function(){this.element.attr("id","hdOutlineDiv"),this.LayoutRoot=a('<div id="hdOutlineContent"/>').appendTo(this.element),this.Tree=a('<div id="hdOutlineTree"/>').appendTo(this.LayoutRoot).Tree({NodeClick:m(this.OutlineTree_NodeClick,this),EnableExpandFadeIn:!0}).on("NodeExpanded",m(this.Tree_NodeExpanded,this)),this.Caption=a("<div id='hdOutlineTitle'/>").appendTo(this.LayoutRoot),this.CloseImage=a("<div style='position:absolute; top:0px; right:0px; height:100%;'><div class='hd-img hd-closex'/></div>").appendTo(this.Caption),this.PinImage=a("<div style='position:absolute; top:0px; right:25px; height:100%;'><div class='hd-img hd-dock-io'/></div>").appendTo(this.Caption),this.CaptionText=a("<span class='hd-ol-caption-text'/>").appendTo(this.Caption).text(l.Lc.GetStr("ui_io")),this.Caption.children("div").css("padding-top",Math.max(0,(this.CloseImage.height()-this.CloseImage.children().height())/2)+"px"),this.Tree.css("top",this.Caption.outerHeight()),this._setOption("height",this.element.height()),this._inUpdate=!1},_setOption:function(b,c){switch(a.Widget.prototype._setOption.apply(this,arguments),b){case"height":this.Tree.height(c-this.Caption.outerHeight())}},Tree_NodeExpanded:function(){this.element.trigger("NodeExpanded",this,{})},GetNodeAtPoint:function(){},CaptionWidth:function(){return this.CaptionText.width()},OnNodeSelected:function(a){this.element.trigger("NodeSelected",new l.Interview.NodeEventArgs(a))},OutlineTree_NodeClick:function(b,c){if(!this._inUpdate){var d=c,e=a(d)[n]("option","ID");if(!a(d)[n]("option","IsEnabled"))return;e>0&&this.OnNodeSelected(e)}},UpdateNodeTitle:function(a,b){var c=new d.Text.StringBuilder,h=g.None;l.Dialog.DialogControl.DotCodeParser().Parse(new f(a.GetOutlineCaption(h)),new e(c,d.Windows.TextWrapping.NoWrap)),b[n]({Title:c.ToString(),OutlineFontFlags:h})},UpdateNodeStatus:function(a,b){var c="",d=!1;a.Type()!=i.Repeat||a.IsSpreadsheet()?c+="hd-dlg-":(c+="hd-rpt-",d=!0),!d&&a.New()?c+="n":a.AnsStatus().IsHasErrorText()&&a.Enabled()?c+="r":a.AnsStatus().Status()==h.Answered?c+="a":a.AnsStatus().IsUnansweredRequired()&&a.Enabled()?c+="r":a.AnsStatus().Status()==h.PartiallyAnswered?c+="p":a.AnsStatus().Status()==h.Unanswered&&(c+="u"),0!=(a.UpdateFlags()&j.NodeEnabled)&&b[n]({IsEnabled:a.Enabled()}),b[n]({IconContent:(a.Enabled()?"hd-img":"hd-img-g")+" "+c})},UpdateTreeNode:function(b,c){var d,e,f,g,h,i=0;for(g=0;g<c.length;g++)if(h=c[g],h.ShowInOutline()){for(e=i;e<b.Count()&&b.get(e)[n]("option","ID")!=h._id;e++);if(e<b.Count()){for(f=i;e>f;f++)b.RemoveAt(i);d=b.get(i++),0!=(h.UpdateFlags()&j.NodeTitle)&&this.UpdateNodeTitle(h,d),0!=(h.UpdateFlags()&j.StatusRelated)&&this.UpdateNodeStatus(h,d)}else d=a("<li/>")[n]({Style:"InterviewOutlineStyle",ID:h._id,HasChildren:h.HasVisibleChildren()}),this.UpdateNodeTitle(h,d),this.UpdateNodeStatus(h,d),b.Insert(i++,d);(0!=(h.UpdateFlags()&j.NodeChildCount)||0!=(h.DescendantUpdateflags()&j.OutlineRelated))&&this.UpdateTreeNode(d.data("hd-"+n).Nodes,h.OutlineChildren())}for(;i<b.Count();)b.RemoveAt(i)},Update:function(a,b){var c,d,e=this;if(!e._inUpdate){if(e._inUpdate=!0,null!=a&&(a.HasVisibleChildren()?e.UpdateTreeNode(e.Tree.data("hd-Tree").Nodes,a.OutlineChildren()):e.Tree.data("hd-Tree").Nodes.Clear()),b>=0&&(c=e.Tree.Tree("Get",b),null!=c)){for(d=c.parents("li:first");d.length>0;)d[n]("option","IsExpanded")||d[n]("Expand"),d=d.parents("li:first");c[n]("option","IsExpanded")||c[n]("Expand"),e.Tree.Tree("Selected",c)}e._inUpdate=!1}}}),l.Interview.NodeEventArgs=function(a){this.NodeID=a},a.hd.OutlineControl}),define("runtime/numbervalidationresult",[],{Valid:0,ErrorNotANumber:1,ErrorTooBig:2,ErrorTooSmall:3,ErrorOutOfRange:4}),define("engine/datasourceloadresult",[],function(){function a(a,b,c){this.Nodes=a,this.Rows=b,this.Error=c}return a}),define("system/exception/invalidoperationexception",["hdmain/system","system/exception/systemexception"],function(a,b,c){function d(){d.baseConstructor.apply(this,arguments)}var e=HOTDOC$;return this.DEBUG===c&&(this.DEBUG=e.DEBUG),a.ExtendClass(d,b),d}),define("engine/formattingcontext",[],{PlainText:0,OutlineText:1,RichText:2}),define("system/exception/notimplementedexception",["hdmain/system","system/exception/systemexception"],function(a,b,c){function d(){d.baseConstructor.apply(this,arguments)}var e=HOTDOC$;return this.DEBUG===c&&(this.DEBUG=e.DEBUG),a.ExtendClass(d,b),e.NotImplementedException=d,d}),define("engine/dotcode",["system/exception/notimplementedexception","engine/formattingcontext","engine/interviewnodeoutlinefontflags"],function(a,b,c){function d(a,d,e){return a?a.indexOf("Â«")<0?a:(d==b.PlainText?a=g.PreProcessForPlainText(a):d==b.OutlineText&&(e.val=c.None,a=g.PreProcessForOutlineText(a,e)),a):""}function e(b,d,e){if(e=c.None,b.indexOf("Â«")<0)return b;throw new a}function f(a,b){a=a.replace(/Â«Â«/gi,"{{FQ}}");for(var d,e=0,f=0,g=0,h=/Â«\s*\.(\w{1,2})\b\s*([^Â»]*)Â»/g,i=h.exec(a);null!=i;){if(3==i.length){switch(d=!0,i[1].toLowerCase()){case"b":e++;break;case"be":e--;break;case"i":f++;break;case"ie":f--;break;case"u":g++;break;case"ue":g--;break;case"f":break;case"fe":break;case"h":break;case"he":break;case"s":break;case"se":break;case"w":break;case"we":break;case"x":break;case"xe":break;case"z":break;case"ze":break;default:d=!1}d&&(a=a.substr(0,i.index)+a.substr(i.index+i[0].length),h.lastIndex=i.index)}i=h.exec(a)}return b&&(b.val=c.None,e>0&&(b.val|=c.Bold),f>0&&(b.val|=c.Italic),g>0&&(b.val|=c.Underline)),a=a.replace(/{{FQ}}/gi,"Â«")}var g={DefaultProcessor:d,HTMLProcessor:e,PreProcessForPlainText:function(a){return f(a)},PreProcessForOutlineText:function(a,b){return f(a,b)}};return g}),define("system/exception/ArgumentNullException",["hdmain/system","system/exception/argumentexception"],function(a,b,c){function d(){d.baseConstructor.apply(this,arguments)}var e=HOTDOC$;return this.DEBUG===c&&(this.DEBUG=e.DEBUG),a.ExtendClass(d,b),d}),define("engine/answeredstatustabulator",["hdmain/system","./answeredstatus"],function(a,b){function c(){this._flags=0,this._explicitlyAnswered=0,this._implicitlyAnswered=0,this._unanswered=0}function d(a,b){a._explicitlyAnswered+=b._explicitlyAnswered,a._implicitlyAnswered+=b._implicitlyAnswered,a._flags|=b._flags&(e.O|e.I),b._unanswered>0&&(a._unanswered+=b._unanswered,b.IsUnansweredRequired()&&(a._flags|=e.D))}var e={N:0,O:1,I:2,R:4,D:8,E:16,DE:32};return a.ExtendClass(c,null,{Reset:function(){this._flags=0,this._explicitlyAnswered=this._implicitlyAnswered=this._unanswered=0},IncAnswered:function(a,b,c){a||b?c?this._implicitlyAnswered++:this._explicitlyAnswered++:this._flags|=c?e.I:e.O},IncUnanswered:function(a,b){(a||b)&&(this._unanswered++,b&&(this._flags|=e.R))},SetError:function(){this._flags|=e.E},ClearRequired:function(){this._flags&=~e.R},ClearError:function(){this._flags&=~e.E},IsAnswered:function(){return this._explicitlyAnswered>0||0!=(this._flags&e.O)},Status:function(){return 0==this._unanswered?b.Answered:this._explicitlyAnswered>0||this._implicitlyAnswered>0||0!=(this._flags&(e.O|e.I))?b.PartiallyAnswered:b.Unanswered},IsAllAnswered:function(){return 0==this._unanswered},IsUnansweredRequired:function(){return 0!=(this._flags&(e.R|e.D))},IsThisUnansweredRequired:function(){return 0!=(this._flags&e.R)},IsHasErrorText:function(){return 0!=(this._flags&(e.E|e.DE))},IsThisHasErrorText:function(){return 0!=(this._flags&e.E)},UnansweredCount:function(){return this._unanswered},AnsweredCount:function(){return this._explicitlyAnswered+this._implicitlyAnswered},TotalCount:function(){return this.AnsweredCount()+this.UnansweredCount()}},{Aggregate:d}),c}),define("engine/interviewnodelist",["hdmain/system","engine/interviewnodetype","engine/dialogupdateflags"],function(a,b,c,d){function e(a){this._list=[],this._parent=a,this._updatedCount=0}var f=HOTDOC$;return this.DEBUG===d&&(this.DEBUG=f.DEBUG),a.ExtendClass(e,null,{FindExisting:function(a,b,c,d){for(var e=null,f=this._updatedCount;f<this._list.length&&(this._list[f].Variable().name!=a||this._list[f].Owner()!=c||this._list[f].TemplateOfOrigin()!=d);)f++;return f<this._list.length&&(e=this._list[f],!1),e},PrepareToUpdate:function(a){"number"==typeof a?this._updatedCount=a:(this._updatedCount=f.jq.inArray(a,this._list),!1)},FinishUpdating:function(){this._updatedCount=this._list.length},IndexOf:function(a,b,c){if("object"==typeof a){if(b)return this._list.IndexOf(a,b,c);for(var d=0;d<this._list.length;d++)if(this._list[d]==a)return d}else if("string"==typeof a)for(d=0;d<this._list.length;d++)if(this._list[d].Variable().name==a)return d;return-1},IndexOfID:function(a){var b,c=Count;for(b=0;c>b;b++)if(this._list[b]._id==a)return b;return-1},get:function(a){return"number"==typeof a?this._list[a]:(a=this.IndexOf(a),a>=0?this._list[a]:null)},Add:function(a){(this._updatedCount==this.Count()||this.get(this._updatedCount)!=a)&&(this._list.splice(this._updatedCount,0,a),a.SetUpdateFlags(c.NewlyAdded|c.ScriptAnswer),a.NotifyParentOfChildCountChange(!1)),this._parent.Type()==b.Root?this._updatedCount>0&&!this._list[this._updatedCount-1].Enabled()&&a.Enabled(!1):this._parent.Enabled()||a.Enabled(!1),this._updatedCount++,a.SendUpdateFlagsUpstream(c.All,!1)},Insert:function(a,d){var e;if(this._list.splice(a,0,d),this._parent.Type()==b.Repeat)for(e=a+1;e<this._list.length;e++)this._list[e].OffsetIndex(1,d.Indices().length-1);d.SetUpdateFlags(c.NewlyAdded),d.NotifyParentOfChildCountChange(!1),this._updatedCount++,d.SendUpdateFlagsUpstream(c.All,!1)},Move:function(a,c){var d=this._list[a];if(this._list.splice(a,1),this._list.splice(c,0,d),d.NotifyParentOfChildCountChange(!1),this._parent.Type()==b.Repeat){this._list[c].OffsetIndex(c-a,d.Indices().length-1);for(var e=c>a?-1:1,f=c+e;f!=a+e;f+=e)this._list[f].OffsetIndex(e,d.Indices().length-1)}},Remove:function(a){if(null==a)return!1;var b=this.IndexOf(a);return-1==b?!1:(this.RemoveAt(b),!0)},RemoveAt:function(a){var c,d={startIndex:0,endIndex:0},e=this._list[a],f=e.Indices().length-1;for(e.Children().Clear(),e.FindNodesAskedImplicitly(d);d.startIndex<d.endIndex;)this._parent._interview.Root().Children().RemoveAt(d.startIndex),d.endIndex--;if(e.NotifyParentOfChildCountChange(!1),e.Type()!=b.Repeat&&this._parent._interview.UnregisterNode(e),this._list.splice(a,1),this._parent.Type()==b.Repeat)for(c=a;c<this._list.length;c++)this._list[c].OffsetIndex(-1,f);a<this._updatedCount&&this._updatedCount--},RemoveUntil:function(a){for(;this._list[this._updatedCount]!=a;)this.RemoveAt(this._updatedCount)},Trim:function(){for(;this._updatedCount<this._list.length;)this.RemoveAt(this._list.length-1)},TrimUnanswered:function(){for(;this._updatedCount>0&&!this._list[this._updatedCount-1].AnsStatus().IsAnswered();)this._updatedCount--,this._parent._interview.DecRpt()},Clear:function(){for(;this._list.length>0;)this.RemoveAt(this._list.length-1);this.ClearUpdated()},ClearUpdated:function(){this._updatedCount=0},Contains:function(a){return this.IndexOf(a)>=0},CopyTo:function(a,b){for(var c=0;c<this._list.length;c++)a.splice(b+c,0,this._list[c])},Count:function(){return this._list.length},UpdatedCount:function(){return this._updatedCount},IsReadOnly:function(){return!1},toString:function(){var b=this.Count();return a.String.Format("{0} child{1} of {2}",b.toString(),1==b?"":"ren",this._parent.toString())}}),e}),define("engine/baseinterviewnode",["hdmain/system","system/exception/notimplementedexception","system/exception/ArgumentNullException","engine/answeredstatustabulator","engine/interviewnodetype","engine/dialogupdateflags","require","engine/interviewnodelist"],function(a,b,c,d,e,f,g,h,i){function j(a,b,c){switch(this._interview=a,this._type=b,this._parent=c,this._updateFlags=f.None,this._descendantUpdateFlags=f.None,this._answeredStatus=new d,this._enabled=!0,b){case e.DefaultDialog:this._children=g("engine/defaultdialognode")._emptyChildren();break;case e.Repeat:this._children=new h(this,8);break;default:this._children=new h(this)}}function k(){var a;return a=this.Type()==e.Root?[]:k.call(this._parent),a.push(this),a}function l(b){b.WriteStartElement(a.Enum.GetName(e,this._type))}function m(a){a.WriteEndElement()}var n=HOTDOC$,o=a.Cast,p=a.String.IsNullOrEmpty;return a.ExtendClass(j,null,{DoAnswerSync:function(){this._interview.DoAnswerSync()},InitializeId:function(){this._id=this._interview.GetIdForNode(this)},Enabled:function(a){return a===i?this._enabled:(this._enabled!=a&&(this._enabled=a,this.SetUpdateFlags(f.NodeEnabled)),void 0)},InitUpdate:function(){this._children.ClearUpdated()},GetResourceString:function(a){return n.Lc.GetStr(a)},GetResourceButtonCaption:function(){var a=this._interview.PreferenceCache().ResourceButtonText();return p(a)&&(a=n.Lc.GetStr("rs_bcap")),a},InterviewImageUrl:function(){return this._interview._engine.InterviewImageUrl()},SinglePageMode:function(){return this._interview.IsSinglePage()},UpdateFlags:function(){return this._updateFlags},DescendantUpdateflags:function(){return this._descendantUpdateFlags},SetUpdateFlags:function(a){var b,c;this._updateFlags|=a,this._type==e.Repeat&&(b=a&(f.RepeatAnswer|f.ChildCount|f.NodeChildCount),0!=b&&this.SetDescendantUpdateFlags(b,!1)),c=f.AnswerRelated,this._interview.InRebuild()||(c|=f.NodeChildCount|f.ChildCount,this.SinglePageMode()&&(c|=f.AddButtonRefresh)),0!=(a&c)&&null!=this._parent&&this._parent.SetDescendantUpdateFlags(a&c,!0)},SetUpdateFlagsCascading:function(a){var b,c;for(b=0;b<this._children.Count();b++)c=this._children.get(b),0!=(a&(f.NodeChildCount|f.ChildCount))?c.Children().Count()>0?c.SetUpdateFlagsCascading(a):c.SetUpdateFlagsCascading(a^(f.NodeChildCount|f.ChildCount)):c.SetUpdateFlagsCascading(a);this.SetUpdateFlags(a)},NotifyParentOfChildCountChange:function(a){null!=this._parent&&(this._parent.Type()==e.Repeat&&this._parent.SetUpdateFlags(f.RepeatAnswer),this._parent.SetDescendantUpdateFlags(f.NodeChildCount|f.ChildCount,a))},SendUpdateFlagsUpstream:function(a,b){var c=(this._updateFlags|this._descendantUpdateFlags)&a&~f.NewlyAdded;c!=f.None&&null!=this._parent&&this._parent.SetDescendantUpdateFlags(c,b)},SetDescendantUpdateFlags:function(a,b){this._descendantUpdateFlags|=a,b&&null!=this._parent&&this._parent.SetDescendantUpdateFlags(a,!0)},ClearUpdateFlags:function(a){var b,c=a^f.All,d=this.Children();for(this._updateFlags&=c,this._descendantUpdateFlags&=c,b=0;b<d.Count();b++)d.get(b).ClearUpdateFlags(a)},AnsStatus:function(){return this._answeredStatus},NeedsAnsweredStatusUpdate:function(){return 0!=(this._updateFlags&(f.AnswerRelated|f.Required|f.NodeError))||0!=(this._descendantUpdateFlags&f.StatusRelated)},UpdateAnsweredStatus:function(a){var b=g("engine/interviewnode");if(a||0!=(this._descendantUpdateFlags&(f.AnswerRelated|f.Required|f.NodeError))||0!=((this._updateFlags|this._descendantUpdateFlags)&f.NodeChildCount)||!this.Enabled()&&null==this._interview.RequiredNode()||this.Enabled()&&null!=this._interview.RequiredNode()||0!=(this._updateFlags&f.AnswerRelated)&&this._type==e.Iteration){var c=this._interview;n.jq.each(this.Children()._list,function(b,d){d.UpdateAnsweredStatus(a||null!=c._reqNodeOld&&null==c.RequiredNode()&&c._reqNodeOld.IsDescendantOf(d))})}this.NeedsAnsweredStatusUpdate()&&this.TabulateAnsweredStatus(),this._answeredStatus.IsThisUnansweredRequired()&&null==this._interview.RequiredNode()?(this._interview.SetRequiredNode(o(this,b)),this.Enabled(!0)):(null!=this._interview.RequiredNode()||null!=this._interview._reqNodeOld)&&(this.Enabled(null==this._interview.RequiredNode()||this.ContainsDescendant(this._interview.RequiredNode())),this==this._interview._reqNodeOld&&null==this._interview.RequiredNode()&&this._interview.SetRequiredNode(null)),this._answeredStatus.IsThisHasErrorText()&&null==this._interview.ErrorNode()?(this._interview.SetErrorNode(o(this,b)),this.Enabled(!0)):(null!=this._interview.ErrorNode()||null!=this._interview._errNodeOld)&&(this.Enabled(null==this._interview.ErrorNode()||this.ContainsDescendant(this._interview.ErrorNode())),this==this._interview._errNodeOld&&null==this._interview.ErrorNode()&&this._interview.SetErrorNode(null)),null!=this._parent&&0!=((this._updateFlags|this._descendantUpdateFlags)&f.StatusRelated)&&this.SendUpdateFlagsUpstream(f.StatusRelated,!1)
},DoAnsweredStatusTabulation:function(){throw new b},TabulateAnsweredStatus:function(){var a,b=this._answeredStatus.Status(),c=this._answeredStatus.IsUnansweredRequired(),d=this._answeredStatus.TotalCount(),e=this._answeredStatus.AnsweredCount();this.DoAnsweredStatusTabulation(),a=f.None,(b!=this._answeredStatus.Status()||c!=this._answeredStatus.IsUnansweredRequired())&&(a=f.NodeAnsStatus|f.AnsweredStatus),this._interview.WantProgressNotifications()&&(e!=this._answeredStatus.AnsweredCount()||d!=this._answeredStatus.TotalCount())&&(a|=f.Progress),a!=f.None&&this.SetUpdateFlags(a)},IsDescendantOf:function(a){if(null==a)throw new c("ancestor");if(this.Type()==e.Root)return!1;for(var b=this._parent;null!=b;){if(b==a)return!0;b=b._parent}return!1},ContainsDescendant:function(a){return a.IsDescendantOf(this)},OutlineParent:function(){var a=g("engine/interviewnode");return o(this._parent,a)},Type:function(){return this._type},Children:function(){return this._children},OutlineChildren:function(){return this._children._list},OutlineChildrenReverse:function(){var a,b=[];for(a=this._children.Count()-1;a>=0;a--)b.push(this._children.get(a));return b},New:function(){return!1},IsHiddenNew:function(){return!1},UserExtendible:function(){return!0},NewIterationNode:function(){var a=g("engine/iterationnode"),b=this,c=null;do b.Type()==e.Iteration&&b.New()&&(c=o(b,a)),b=b._parent;while(b.Type()!=e.Root);return c},AllNew:function(){for(var a=!1,b=this;b.Type()!=e.Root;){if(b.Type()==e.Iteration){if(!b.New()){a=!1;break}a=!0}b=b._parent}return a},Active:function(){return!0},AvailableForNavigation:function(){return!1},HasVisibleChildren:function(){var a,b=this.OutlineChildren();for(a=0;a<b.length;a++)if(b[a].ShowInOutline())return!0;return!1},OnSinglePage:function(){return this._parent._type==e.Root?!0:!1},HasAncestorOnSinglePage:function(a){var b,c,d=!1,e=g("engine/interviewnode");if(!this.OnSinglePage()){d=!0,b=this;do b=b._parent;while(null!=b&&!b.OnSinglePage());c=o(b,e),null!=c&&(a.v=c._id)}return d},DirtySinglePage:function(){if(this.OnSinglePage()){this.SetUpdateFlags(f.All);var a,b;for(a=0;a<this._children.Count();a++)b=this._children.get(a),b.DirtySinglePage()}},ComesAfter:function(a){if(null==a)return!1;if(this==a)return!1;for(var b,c,d=g("engine/interviewnode"),e=k.call(this),f=k.call(a),h=1,i=Math.min(e.length,f.length);i>h&&e[h]==f[h];)h++;return h==i?!1:(b=e[h-1].Children().IndexOf(o(e[h],d)),c=f[h-1].Children().IndexOf(o(f[h],d)),b>c)},Serialize:function(a){l.call(this,a),this.SerializeAttributes(a),this.SerializeElements(a),m(a)},SerializeAttributes:function(a){this._enabled||a.WriteAttributeString("Enabled",this._enabled.toString()),this._answeredStatus.IsThisUnansweredRequired()?a.WriteAttributeString("Required","true"):this._answeredStatus.IsUnansweredRequired()&&a.WriteAttributeString("Required","child"),this._answeredStatus.IsThisHasErrorText()?a.WriteAttributeString("ErrorText","true"):this._answeredStatus.IsHasErrorText()&&a.WriteAttributeString("ErrorText","child"),a.WriteAttributeString("Status",this._answeredStatus.Status().toString())},SerializeElements:function(a){var b,c;if(null!=this._children&&(b=this._children.Count(),b>0)){for(a.WriteStartElement("Children"),c=0;b>c;c++)this._children.get(c).Serialize(a);a.WriteEndElement()}},toString:function(){return a.String.Format("{0} Node",this.Type().toString())}}),j}),define("engine/interviewnode",["hdmain/jq","runtime/numbervalidationresult","hdmain/system","engine/datasourceloadresult","system/exception","system/exception/invalidoperationexception","engine/formattingcontext","engine/interviewnodeoutlinefontflags","engine/dotcode","engine/interviewnodetype","engine/baseinterviewnode","engine/dialogupdateflags","require"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a,b,c,d,e){o.baseConstructor.call(this,a,b,c),this._autoHidden=!1,this._active=!0,this.EmptyItemNodes=new q.DialogItemNodeList(0),this._template=a.CurrentTemplate(),this._dialog=d,this._indices=e,this._owner=a.InRebuild()&&a.CurrentBuildNode()!=c?x(a.CurrentBuildNode(),o):null,this._itemNodes=this.EmptyItemNodes,this._focusedItem=-1}function p(){}var q=HOTDOC$;this.DEBUG===n&&(this.DEBUG=q.DEBUG);var r=a.proxy,s="IsSpreadsheetRowInSpreadsheet",t=q.FocusDirection={Forward:0,Reverse:1},u=q.FocusOperation={ReassertOnly:0,AdvanceIfNecessary:1,Advance:2},v=c.String.IsNullOrEmpty,w=c.String.Format,x=c.Cast,y=q.Lc;return c.ExtendClass(o,k,{Variable:function(){return this._dialog},TemplateOfOrigin:function(){return this._template},Indices:function(){return null!=this._indices?this._indices:[]},OutlineChildren:function(){var a,b,c,d=[];for(a=0;a<this._children.Count();a++)if(c=this._children.get(a),c.IsOnParent())for(b=0;b<c.OutlineChildren().length;b++)d.push(c.OutlineChildren()[b]);else d.push(c);return d},OutlineChildrenReverse:function(){var a,b,c,d=[];for(a=this._children.Count()-1;a>=0;a--)if(c=this._children.get(a),c.IsOnParent())for(b=0;b<c.OutlineChildrenReverse().length;b++)d.push(c.OutlineChildrenReverse()[b]);else d.push(c);return d},AskedImplicitly:function(){return null!=this._owner},Owner:function(){return this._owner},IsSpreadsheetRow:function(){return this.Type()==j.Iteration&&"S"==this._dialog.rType},IsSpreadsheetRowInEditMode:function(){return this.IsSpreadsheetRow()&&this._parent.EditRowMode()},IsSpreadsheetRowInSpreadsheet:function(){return this.IsSpreadsheetRow()&&!this._parent.EditRowMode()},IsOnParent:function(){return this._dialog.onPar?this._parent.Type()==j.Root?!1:this._parent.Type()==j.Iteration&&this._parent[s]()?!1:!0:!1},OnSinglePage:function(){return this.IsOnParent()?this._parent.OnSinglePage():o.baseclass.OnSinglePage.call(this)},ClearUpdateFlags:function(a){0!=(a&l.DialogContentRelated)&&this._itemNodes.ClearUpdateFlags(),o.baseclass.ClearUpdateFlags.apply(this,arguments)},SetIndex:function(a){var b,c,d=m("engine/iterationnode");if(!q.RepeatIndices.AreRelated(a,this._indices))for((this._type==j.Iteration&&!this[s]()||this._parent.Type()==j.Iteration&&x(this._parent,d)[s]())&&this.SetUpdateFlags(l.Title|l.NodeTitle),this._indices=q.RepeatIndices.SetBaseIndices(this._indices,a),b=0;b<this._children.Count();b++)c=this._children.get(b),c.SetIndex(a)},OffsetIndex:function(a,b){var c,d=m("engine/iterationnode");for(this._indices[b]+=a,(this._type==j.Iteration&&!this[s]()||this._parent.Type()==j.Iteration&&x(this._parent,d)[s]())&&this.SetUpdateFlags(l.Title|l.NodeTitle),this._interview.OffsetIndicesForId(this._id,a,b),c=0;c<this._children.Count();c++)child=this._children.get(c),child.OffsetIndex(a,b)},GetCaption:function(a,b,c){return c=h.None,this._parent.Type()==j.Iteration&&this._parent[s]()?this._parent.New()?y.GetStr("ui_new")+": "+(v(this._title)?this._dialog.name:b(o.FixAmpersands(this._title,!1),a,c)):q.RepeatIndices.ToPrefixString(this._indices)+(v(this._title)?this._dialog.name:b(o.FixAmpersands(this._title,!1),a,c)):null==this._title||""==this._title?this.Variable().name:b(o.FixAmpersands(this._title,!1),a,c)},New:function(){var a=m("engine/iterationnode");return this._parent.Type()==j.Iteration&&x(this._parent,a)[s]()?this._parent.New():o.baseclass.New.call(this)},IsHiddenNew:function(){var a=m("engine/iterationnode");return this._parent.Type()==j.Iteration&&x(this._parent,a)[s]()?this._parent.IsHiddenNew():o.baseclass.IsHiddenNew.call(this)},RequiredAsterisk:function(){return this._interview._engine.RequiredAsterisk()},RequiredIsEnforcable:function(){if(!this.Active())return!1;if(this._type==j.Iteration){var a=m("engine/iterationnode"),b=x(this,a);if(b.New()&&b.IterationNumber()>0)return!1}return this.AllNew()&&!q.RepeatIndices.IsFirst(this._indices)?!1:this.GetIsPartOfInterview()?!0:!1},GetIsPartOfInterview:function(){var a=!0;return this._parent.Type()!=j.Root&&(a=x(this._parent,o).GetIsPartOfInterview()),a&&(a=this._parent.Children().Contains(this)),a},Caption:function(){var a;return this.GetCaption(g.PlainText,i.DefaultProcessor,a)},GetOutlineCaption:function(a){return this.GetCaption(g.OutlineText,i.DefaultProcessor,a)},Title:function(a){return a===n?this._title:(a!=this._title&&this.SetUpdateFlags(l.Title|l.NodeTitle),this._title=a,void 0)},AutoHidden:function(a){return a===n?this._autoHidden:(this._autoHidden!=a&&(this._autoHidden=a,this.Active(!a)),void 0)},Active:function(a){if(a===n)return this._active;if(this._active!=a&&(this._active=a,this._parent.SetUpdateFlags(l.NodeChildCount|l.ChildCount),!this._active))for(child in this.Children)child.Active(!1)},IsOwnedBy:function(a){if(!this.AskedImplicitly())return!1;if(this._owner==a)return!0;if(this._owner.AskedImplicitly())return this._owner.IsOwnedBy(a);if(this._owner.IsDescendantOf(a))return!0;for(var b=x(this._owner.Parent,o);null!=b&&!b.AskedImplicitly();)b=x(b.Parent,o);return null!=b?b.IsOwnedBy(a):!1},FindNodesAskedImplicitly:function(a){for(var b,c=this;c._parent.Type()!=j.Root;)c=x(c._parent,o);for(b=x(c._parent,q.RootNode),a.endIndex=b.Children().IndexOf(c),a.startIndex=a.endIndex;a.startIndex>0&&b._children.get(a.startIndex-1).AskedImplicitly();)a.startIndex--;for(;a.startIndex<a.endIndex&&!b._children.get(a.startIndex).IsOwnedBy(this);)a.startIndex++;for(;a.endIndex>a.startIndex&&b._children.get(a.endIndex-1).AskedImplicitly()&&!b._children.get(a.endIndex-1).IsOwnedBy(this);)a.endIndex--},GetNodesAskedImplicitly:function(){var a,b={startIndex:0,endIndex:0},c=[];for(this.FindNodesAskedImplicitly(b),a=b.startIndex;a<b.endIndex;a++)c.push(this._interview.Root.Children().get(a));return c},GenerateDefaultTitle:function(){var a,b,c,d=this._dialog,e=null,f=null,g=!1,h=0;for(h=0;h<d.vList.Count();h++){if(e=d.vList.GetItem(h),e instanceof q.Variable){for(a=h+1;a<d.vList.Count();a++)if(d.vList.GetItem(a)instanceof q.Variable){g=!0;break}b=e,f=b.EvTitle(),v(f)&&(f=o.TrimForUseAsTitle(b.EvPrompt()),v(f)&&(f=b.name));break}if("TXL"==e.type){if(c=e,f=o.TrimForUseAsTitle(c.EvText()),!v(f))break}else if("HDL"==e.type&&(c=e,f=c.EvCapt().replace(/^\s+|\s+$/g,""),!v(f)))break}return v(f)?f=y.GetStr("ui_emptydlg"):"NONE"==f&&(f="",g=!1),g&&(f+=y.GetStr("ui_etc")),f},EvTitle:function(){var a=this._dialog.EvTitle();return v(a)&&this._interview.PreferenceCache().GenerateDialogTitles()&&(a=this.GenerateDefaultTitle()),a},EvaluateText:function(){this.Title(this.EvTitle()),this._updateFlags|=this._itemNodes.Update()},ShowInOutline:function(){return this.AutoHidden()?!1:this.Active()&&!this.IsHiddenNew()},AvailableForNavigation:function(){return this.ShowInOutline.call(this)},DoImplicitAnswerProcessing:function(){},ClearGroupedItems:function(a,b,c){if(this._type!=j.Dialog&&this._type!=j.Iteration)throw new f(y.GetStr("err_grptf"));if(""==this._dialog.gType&&!IsSpreadsheetRow)throw new f(y.GetStr("err_grptf_un"));this._interview.BeginBulkAnswerChange();var d,e,g,h=!1;for(d=a;b>=d;d++)e=this._itemNodes.get(d),e!=c&&(g=e.DialogItem(),("TF"==g.type||"DI"==g.type)&&(this._interview._engine.LoadAnswerValue("TF",g.name,!1,x(g,q.Variable).saveAns,this._indices),e.SetUpdateFlags(l.ScriptAnswer),h=!0));if(this._dialog.nota&&(h||a==b)){if(!this._itemNodes.get(b+1).NoneOfTheAbove())throw new f("Failed to find None of the Above item in the expected position.");this._itemNodes.get(b+1).SetUpdateFlags(l.ScriptAnswer)}this._interview.EndBulkAnswerChange(!1)},ClearAnswers:function(a){"boolean"!=typeof a&&(a=!0),this._interview.BeginBulkAnswerChange(),a&&this.DoAnswerSync();var b,c;for(b=0;b<this._itemNodes.Count();b++)c=this._itemNodes.get(b),c.ClearAnswer(!1);this.DoImplicitAnswerProcessing(),this._interview.EndBulkAnswerChange(!0)},VariableHasAnswer:function(a){if(null!=a){var b=this._interview._engine.GetAnswer(a.name);if(b!==n)return b.IsAns(this._indices)}return!1},VariableIsUserModifiable:function(a){var b,c=!1;return null!=a&&(c=!0,b=this._interview._engine.GetAnswer(a.name),null!=b&&(c=b.GetUserModifiable(this._indices),c&&this.Type()==j.Iteration&&this.New()&&!this.UserExtendible()&&(c=!1))),c},GetVariableAnswerDouble:function(a){var b,c=this._interview._engine.GetAnswer(a.name);return null!=c&&(b=c.GetValue(this._indices),null!=b)?b:null},GetVariableAnswerDate:function(a,b){var c,d=this._interview._engine.GetAnswer(a.name);return null!=d&&(c=d.GetValue(this._indices),null!=c)?(b.v=c,!0):!1},GetVariableAnswerList:function(a,b){var c,d=this._interview._engine.GetAnswer(a.name);return d===n&&a.dv&&(d=q.Answers.CreateAnswer("MC",a.name)),null!=d&&(c={v:d.GetValue(this._indices)},null==c.v&&a.dv&&(!this[s]()||0==this._indices[this._indices.length-1])&&(d.SetValue(a.dv,this._indices),c.v=d.GetValue(this._indices)),a.ReconcileOptions(c,this._interview.GetRuntimeOptionsForVariable(a)),null!=c.v)?(b.push.apply(b,c.v),!0):(b=null,!1)},GetVariableAnswerOther:function(a,b){if(a.othr&&!a.MultipleSelect()){var c,d,e=this._interview._engine.GetAnswer(a.name);if(null!=e&&(c=e.GetValue(this._indices),null!=c&&(d=this._interview.GetRuntimeOptionsForVariable(a),!d.Contains(c[0]))))return b=c[0],!0}return b=null,!1},SetVariableAnswerDouble:function(a,c,d){d.v="";var e,f=y.ParseNumber(c);switch(null!=f&&(e=Math.pow(10,a.decPl),f=Math.round(f*e)/e),a.CheckMinMax(f)){case b.Valid:return this._interview._engine.LoadAnswerValue("NU",a.name,f,a.saveAns,this._indices),!0;case b.ErrorNotANumber:d.v=y.GetStr("val_invnum");break;case b.ErrorOutOfRange:d.v=y.GetStr("val_numrng",y.FormatNumberDef(a.min,a.decPl),y.FormatNumberDef(a.max,a.decPl));break;case b.ErrorTooSmall:d.v=y.GetStr("val_numgt",y.FormatNumberDef(a.min,a.decPl));break;case b.ErrorTooBig:d.v=y.GetStr("val_numlt",y.FormatNumberDef(a.max,a.decPl))}return!1},SetVariableAnswerDate:function(a,b){var c=b?new Date(b):null;this._interview._engine.LoadAnswerValue("DA",a.name,c,a.saveAns,this._indices)},SetVariableAnswerList:function(a,b){"string"==typeof b&&(""==b&&(this[s]()||"CO"==a.style||"SL"==a.style)&&(b=null),null!=b&&(b=[b])),this._interview._engine.LoadAnswerValue("MC",a.name,b,a.saveAns,this._indices)},GetItemWidth:function(a){for(var b,c=0,d=1,e=a;e>0&&(1==this._dialog.plcmt[e]||3==this._dialog.plcmt[e]);)e--;for(this._dialog.plcmt[e]>=2&&c++,b=e+1;b<this._dialog.plcmt.length&&(1==this._dialog.plcmt[b]||3==this._dialog.plcmt[b]);)d++,this._dialog.plcmt[b]>=2&&c++,b++;switch(d){case 1:return 100;case 2:return this._dialog.plcmt[a]>=2?67:c>0?33:50;case 3:return 33;default:throw new f("Found more than 3 variables on a single line in the dialog")}},IsItemOnPrevLine:function(a){return 1==this._dialog.plcmt[a]||3==this._dialog.plcmt[a]},GetItemMapName:function(a){var b,c=this._dialog.Mappings[a];return c!==n&&null!=c?c.n:(b=x(this._itemNodes.get(a).DialogItem(),q.Variable),null!=b&&"DI"!=b.type?b.name:null)},GetItemMapType:function(a){var b,c=this._dialog.Mappings[a];return c!==n&&null!=c&&"UN"!=c.ExpectedType&&"OT"!=c.ExpectedType?c.t:(b=x(this._itemNodes.get(a).DialogItem(),q.Variable),null!=b&&"DI"!=b.type?b.valType:"UN")},IsItemInProtectedGroup:function(a){if(""==this._dialog.gType)return!1;var b,c,d,e,f=x(this._itemNodes.get(a).DialogItem(),q.Variable),g={},h={};if(null==f||"TF"!=f.type&&"DI"!=f.type)return!1;if(this._dialog.GetTrueFalseGroupBounds(a,g,h),g.v<0)return!1;for(b=g.v;b<=h.v;b++)if(c=this._dialog.vList.GetItem(b),d=this._interview._engine.GetAnswer(c.name),null!=d&&(e=d.GetValue(this.Indices()),null!=e&&e&&!d.GetUserModifiable(this.Indices())))return!0;return!1},IsAnyVariableProtected:function(){var a,b,c;for(a=0;a<this._dialog.vList.Count();a++)if(b=this._dialog.vList.GetItem(a),c=this._interview._engine.GetAnswer(b.name),null!=c&&!c.GetUserModifiable(this.Indices()))return!0;return!1},NavigateTo:function(a,b,c){this._interview.GotoDialog(this,b,a,null,c)},HasAnswerSource:function(){return!(this.Type()!=j.Dialog&&this.Type()!=j.Iteration||null==this._dialog.DataSource||"CAF"!=this._dialog.DataSource.t&&"AF"!=this._dialog.DataSource.t&&"C"!=this._dialog.DataSource.t)},AnswerSourceColumns:function(){var b=[];return a.each(this.AllAnswerSourceColumns(),function(a,c){c.ConcealedOnAnswerSource()||b.push(c)}),b},AllAnswerSourceColumns:function(){var b=[];return a.each(this._itemNodes._itemNodes,function(a,c){c.DialogItem()instanceof q.Variable&&"DI"!=c.DialogItem().type&&!c.OmittedFromAnswerSource()&&b.push(c)}),b},AnswerSourceTypeIsCompatible:function(a,b){return a==b?!0:"TX"==a&&"MC"==b||"MC"==a&&"TX"==b},GetDataSourcePropertyName:function(a){if(null==this._dialog.DataSource)throw new NullReferenceException("Cannot get a property name when there is no data source defined.");switch(this._dialog.DataSource.t){case"CAF":case"AF":case"C":return a.MapName();default:throw new e(w("The data source type '{0}' is not supported.",this._dialog.DataSource.t))}},LoadDataSourceRows:function(b){if(null==this._dialog.DataSource)throw new NullReferenceException("Cannot load data source rows when there is no data source defined.");var c,f,g,h,i,j,k,l,m,n=this._dialog.DataSource;switch(n.t){case"CAF":c=[],f=[],g=this,a.each(this.AllAnswerSourceColumns(),function(b,d){if(i=g._interview._engine.GetAnswer(d.MapName()),null!=i&&g.AnswerSourceTypeIsCompatible(i.VT(),d.MapType())){for(h=null==i?0:i.GetChildCount(),j=0;h>j;j++)j>=f.length&&f.push(new a.Dictionary),value=i.GetValue([j]),f[j].Add(d.MapName(),value);c.push(d)}}),b(new d(c,f,null));break;case"AF":k=q.DataSourceLoader.GetDataSourceCollection(n.id),null==k?(l="",p.call(this,l),q.DataSourceLoader.LoadAnswerFileDataSource(q.DataSourceAddressDict[n.n.toLowerCase()].Address,q.TemplateLocator,this._template.name,n.id,l,r(function(a){b(new d(this.AllAnswerSourceColumns(),a.Rows(),a.Error()))},this))):b(new d(this.AllAnswerSourceColumns(),k.Rows(),k.Error()));break;case"C":k=q.DataSourceLoader.GetDataSourceCollection(n.id),null==k?(l="",p.call(this,l),m=q.DataSourceAddressDict[n.n.toLowerCase()],q.DataSourceLoader.LoadCustomDataSource(m.Address,m.Name,n.id,l,r(function(a){b(new d(this.AllAnswerSourceColumns(),a.Rows(),a.Error()))},this))):b(new d(this.AllAnswerSourceColumns(),k.Rows(),k.Error()));break;default:throw new e(w("Data sources of type {0} are not supported.",this._dialog.DataSource.t))}},SetAnswersFromAnswerSourceRow:function(a,b){this._interview.BeginBulkAnswerChange();var c,d,e;for(c=0;c<a.length;c++)switch(d=a[c],e=b.TryGetValue(this.GetDataSourcePropertyName(d)),d.DialogItem().type){case"TX":null!=e?"string"==typeof e?d.StringAnswer(e):"array"==typeof e&&d.StringAnswer(e.toString()):d.StringAnswer(null);break;case"NU":null!=e?d.DoubleAnswer(e):d.DoubleAnswer(null);break;case"DA":null!=e?d.DateAnswer(e):d.DateAnswer(null);break;case"TF":null!=e?d.BoolAnswer(e):d.BoolAnswer(null);break;case"MC":null!=e?"object"==typeof e&&e.length?d.ListAnswer(e):"string"==typeof e&&d.StringAnswer(e):d.ListAnswer(null)}this._interview.EndBulkAnswerChange(!0)},GetFocusedItemNode:function(){var a,b,c=null;return this._type==j.Repeat&&x(this,q.RepeatNode).IsSpreadsheet()&&this.IsOnParent()&&!this.EditRowMode()?c=x(this,q.RepeatNode).SpreadsheetItemNode()._parent.GetFocusedItemNode():this._focusedItem>=0&&(c=this._itemNodes.get(this._focusedItem),c.IsSpreadsheet()&&(a=c.SpreadsheetNode(),b=c.GetRowFocus(),b>=0&&b<a.Children().Count()&&(c=a.Children().get(b).GetFocusedItemNode()))),c},ClearFocusedItemNode:function(){var a=m("engine/iterationnode");this._type==j.Repeat&&this.IsSpreadsheet()&&this.IsOnParent()&&!this.EditRowMode()?this.SpreadsheetItemNode()._parent.ClearFocusedItemNode():this._focusedItem>=0&&this._itemNodes.get(this._focusedItem).ClearFocus(),this[s]()&&x(this,a).SpreadsheetItemNode().SetRowFocus(-1),this._focusedItem=-1},SetFocus:function(a){var b=m("engine/iterationnode");if(this._type==j.Repeat&&this.IsSpreadsheet()&&this.IsOnParent()&&!this.EditRowMode())return this.SpreadsheetItemNode()._parent.SetFocus(a),void 0;if(this._focusedItem=a,this[s]()){var c=x(this,b).SpreadsheetItemNode(),d=q.RepeatIndices.GetTopIndex(this._indices);d>=this._parent.Children().Count()&&(d=this._parent.Children().Count()-1),c.SetRowFocus(d)}},AdvanceFocus:function(a,b,c){function d(){this._focusedItem>=0&&this._focusedItem<this._itemNodes.Count()?this._itemNodes.get(this._focusedItem).AssertFocus(a?u.Advance:u.AdvanceIfNecessary,b,r(function(e){return e?(c(e),void 0):(this._focusedItem+=b==t.Forward?1:-1,a=!1,d.call(this),void 0)},this)):(this._focusedItem=-1,c(!1))}if(c===n&&(c=function(){}),this._type==j.Repeat&&this.IsSpreadsheet()&&this.IsOnParent()&&!this.EditRowMode())return this.SpreadsheetItemNode()._parent.AdvanceFocus(a,b,c),void 0;var e,f;return-1==this._focusedItem&&(this._focusedItem=b==t.Forward?0:this._itemNodes.Count()-1,a=!1),a&&!this[s]()&&(e=this.GetFocusedItemNode(),f=!1,null!=e&&(f=e.OnAnswerSync()),f)?(c(!1),void 0):(d.call(this),void 0)},ReassertFocus:function(a){return this._type==j.Repeat&&this.IsSpreadsheet()&&this.IsOnParent()&&!this.EditRowMode()?(this.SpreadsheetItemNode()._parent.ReassertFocus(a),void 0):(this._focusedItem>=0&&this._focusedItem<this._itemNodes.Count()&&this._itemNodes.get(this._focusedItem).AssertFocus(u.ReassertOnly,a),void 0)},GetNextFocusNode:function(a){if(!this._interview.IsSinglePage()||!this.OnSinglePage())return null;var b=this._parent.Children().IndexOf(this),c=null;return a==t.Reverse?b>0?c=this._parent.Children().get(b-1):this._parent.Type()!=j.Root&&(b=this._parent._parent.Children().IndexOf(x(this._parent,o)),b>0&&(c=this._parent._parent.Children().get(b-1))):b<this._parent.Children().Count()-1&&(this._parent.Type()!=j.Repeat||!this._parent.Children().get(b+1).IsHiddenNew())?c=this._parent.Children().get(b+1):this._parent.Type()!=j.Root&&(b=this._parent._parent.Children().IndexOf(x(this._parent,o)),b<this._parent._parent.Children().Count()-1&&(this._parent._parent.Type()!=j.Repeat||!this._parent._parent.Children().get(b+1).IsHiddenNew())&&(c=this._parent._parent.Children().get(b+1))),null!=c&&c.Type()==j.Repeat&&"S"!=c._dialog.rType&&(c=a==t.Forward?c.Children().get(0):c.Children().Count()>1&&c.Children().get(c.Children().Count()-1).IsHiddenNew()?c.Children().get(c.Children().Count()-2):c.Children().get(c.Children().Count()-1)),c},GenerateBookmark:function(){var a,b="";if(b+=this.Variable().name,this._type!=j.DefaultDialog)for(b+="|",b+=this._focusedItem>=0?this._type==j.Repeat?this.Children().get(0).ItemNodes.IndexOfName(this._itemNodes.get(this._focusedItem).DialogItem().name):this._focusedItem:"-1",a=0;a<this._indices.length;a++)b+="|",b+=this._indices[a];return b},SerializeAttributes:function(a){this._type!=j.DefaultDialog&&a.WriteAttributeString("Name",this.Variable().name),null!=this._indices&&this._indices.length>0&&a.WriteAttributeString("Indices",q.RepeatIndices.ToString(this._indices)),null!=this._owner&&a.WriteAttributeString("Owner",this._owner.Variable().name),this._active||a.WriteAttributeString("Active",this._active.toString()),this._autoHidden&&a.WriteAttributeString("AutoHidden",this._autoHidden.toString());var b=Caption;!v(b)&&b!=this.Variable().name&&a.WriteAttributeString("Caption",b),o.baseclass.SerializeAttributes(a)}},{HDEscQuots:function(a,b,c){return"boolean"!=typeof c&&(c=!0),"string"!=typeof a&&null!=typeof a.hdType&&"S"!=a.hdType?"":(b!==!1&&(b=!0),b?(a=a.replace(/&/g,"&amp;"),c&&(a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;")),a=a.replace(/\'/g,"&#39;"),a=a.replace(/\"/g,"&quot;")):(a=a.replace(/&#39;/g,"'"),a=a.replace(/&quot;/g,'"'),c&&(a=a.replace(/&lt;/g,"<"),a=a.replace(/&gt;/g,">")),a=a.replace(/&amp;/g,"&")),a)},FixAmpersands:function(a,b){"string"!=typeof a&&(a=""),"boolean"!=typeof b&&(b=!1);var c,d=b?"&amp;":"&";return a=a.replace(new RegExp("\\"+d+"\\"+d,"g"),"â»â"),a=a.replace(new RegExp("\\"+d+"(\\s|<BR>)","g"),"â»â$1"),c=a.indexOf(d),c>=0&&(a=a.substr(0,c)+"<u>"+a.substr(c+d.length,1)+"</u>"+a.substr(c+d.length+1)),a=a.replace(new RegExp("\\"+d,"g"),""),a=a.replace(new RegExp("â»â","g"),d)},TrimForUseAsTitle:function(a){if(!a)return"";if(""==a)return a;a=a.replace(/<br>/gi,"\n");var b=a.search(/[^-:;,.?! \n\t]/);return b>0&&(a=a.slice(b)),b=a.search(/[\n\t]/),b>0&&(a=a.slice(0,b)),b=a.search(/[-:;.,?! ]+$/),b>0&&(a=a.slice(0,b)),a}}),q.InterviewNode=o,o}),define("interview/interviewcontrol",["hdmain/jq","hdmain/system","dialog/customnavigationbarbuttondef","dialog/customnavigationbar","system/jq.menu/menuitem","system/jq.menu/menu","system/jquery.hd.popup","system/exception/argumentnullexception","interview/sidebar","interview/outlinecontrol","engine/dialogupdateflags","engine/interviewnode"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){this.OutlineVisibility(_.Collapsed)}function o(){this.OutlineVisibility(_.Visible)}function p(a){HDAPI._clickCustTBBtn(a)}function q(a,b){HDAPI._custTBBtnIsActive(a,b)}function r(){HDAPI.DocumentPreview()}function s(){HDAPI._ShowModalResponse(W.HDEngine.GetAnswerSummary(),this._interview[fb]("tb_as"),!0)}function t(){HDAPI._SaveAnswers()}function u(a,b){b(this._interview.IsSinglePage())}function v(){var a=this._dialogControl.DialogControl("option","ResourcePaneVisibility")==_.Visible?_.Collapsed:_.Visible;this.rightBar.SideBar("Slide",null,0,!1),a==_.Visible?this.rightBar.SideBar("Hide"):this.rightBar.SideBar("Show"),this._dialogControl.DialogControl({ResourcePaneVisibility:a}),this.element.resize()}function w(){this._dialogControl.DialogControl({PageMode:this._dialogControl.DialogControl("option","PageMode")==W.PageMode.NormalPaged?W.PageMode.SinglePage:W.PageMode.NormalPaged})}function x(){HDAPI._showInterviewHelp()}function y(a){var b=W.Dialog.HDNavBtnType;switch(a){case 0:return b.TextOnly;case 1:return b.ImageOnly;case 2:return b.ImageLeft;case 3:return b.ImageRight;default:return b.TextOnly}}function z(a){var b=W.Dialog.HDNavBarCell;switch(a){case 0:return b.Left;case 1:return b.Middle;case 2:return b.Right;default:return b.Left}}function A(a){var b=W.Dialog.HDNavSepPos;switch(a){case 0:return b.None;case 1:return b.Left;case 2:return b.Right;case 3:return b.Both;default:return b.None}}function B(){var a=this._buttonImageNames=[];a[ib]=new V("btndp"),a[jb]=new V("btnas"),a[kb]=new V("btnsv"),a[nb]=new V("btnpg",null,"btnpgc"),a[pb]=new V("hdhelp")}function C(a){switch(a){case"HDDocPreview":return ib;case"HDAnsSummary":return jb;case"HDSaveAnswers":return kb;case"HDOutlineToggle":return lb;case"HDInstUpdateToggle":return"";case"HDSinglePageToggle":return nb;case"HDResourcePaneToggle":return ob;case"HDHelp":return pb;default:return a}}function D(a){this.element.trigger("StatusTextChanged",new W.Interview.StatusTextEventArgs(a))}function E(a,b,c,d,e,f,g,h,i,j){i=J.call(this,null,p,a,b,c,d,e?q:null,e?f:null,e?g:null,e?h:null,i,j);var k=this.Toolbar.Children[i];return e&&(null==this._customActiveStateToolbarButtons&&(this._customActiveStateToolbarButtons=[]),this._customActiveStateToolbarButtons.push(k)),k.Tag.ID}function F(a){var b=a.data;N.call(this,b,!0,null).then($(function(){var a=b.Tag;ab(a.StatusText)||D.call(this,a.StatusText)},this))}function G(a){var b=a.data;N.call(this,b,!1,null).then($(function(){var a=b.Tag;ab(a.StatusText)||D.call(this,"")},this))}function H(a){if(1==a.which){var b,c=a.data;b=c.Tag}}function I(a){if(1==a.which){var b,c=a.data;b=c.Tag,b.OnClick()}}function J(b,c,d,e,f,g,h,i,j,k,l,n){if(null==d)return M.call(this,b,c,f,g,h,k,n,l);var o=new T(b,W.Dialog.DialogControl.MayInvokeButton,c,d,e,f,g,h,i,j,k),p=a("<div/>");return p.Tag=o,p.addClass("hdtb-icon").attr("title",g).height(Y),null!==d&&(a("<div/>").appendTo(p).addClass("hd-img hdtb-"+o.ID),"btnod"==o.ID?p.css({"margin-left":"0px","padding-top":Z,"padding-bottom":Z}):p.css({padding:Z})),N.call(this,p,!1,null).then($(function(){p.on("mouseenter",p,$(F,this)).on("mouseleave",p,$(G,this)).on("mousedown",p,$(H,this)).on("mouseup",p,$(I,this)),!ab(b)&&this._hiddenToolbarButtons!==m&&this._hiddenToolbarButtons[b]!==m&&(p.hide(),delete this._hiddenToolbarButtons[b])},this)),o._updateDel=$(function(){o.IsToggleButton()?o.IsActive().then($(function(a){N.call(this,p,o.IsHot,a)},this)):N.call(this,p,o.IsHot,!1)},this),K.call(this,p,l)}function K(b,c){var d,e,f=this.Toolbar.Children.length,g=this._outlineImageIndex>=0&&this._dropdownImageIndex>=0,h=this.ToolbarButtons;for(g&&f--,(0>c||c>f)&&(c=f),g&&c>=parseInt(this.Toolbar.Children[this._dropdownImageIndex].attr("GridColumn"))&&c++,d=0;d<this.Toolbar.Children.length;d++)e=this.Toolbar.Children[d],null!=e&&parseInt(e.attr("GridColumn"))>=c&&e.attr("GridColumn",parseInt(e.attr("GridColumn"))+1);return b.attr("GridColumn",c).appendTo(h),a.each(h.children(),function(){var d=a(this);return this!=b[0]&&parseInt(d.attr("GridColumn"))>=c?(b.insertBefore(d),!1):void 0}),this.Toolbar.Children.push(b),this.Toolbar.Children.length-1}function L(a,b,c,d,e,f){var g=this._buttonImageNames[a];return J.call(this,a,b,g.imageNormal,g.imageHot,c,d,e,g.imageActive,g.imageActiveHot,f,-1)}function M(b,c,d,e,f,g,h,i){var j=new T(b,W.Dialog.DialogControl.MayInvokeButton,c,null,null,d,e,null,null,null,g),k=a("<div/>");return k.Tag=j,k.addClass("hdtb-icon").attr({id:b,title:e}),a("<div/>").addClass("hdtb-text").text(null==h||""==h?" ":h).appendTo(k),N.call(this,k,!1,null),k.on("mouseenter",k,$(F,this)).on("mouseleave",k,$(G,this)).on("mousedown",k,$(H,this)).on("mouseup",k,$(I,this)),!ab(b)&&null!=this._hiddenToolbarButtons&&this._hiddenToolbarButtons[b]!==m&&(k.hide(),delete this._hiddenToolbarButtons[b]),K.call(this,k,i)}function N(b,c,d){function e(d){d?ab(h.ToolTipActive())||(i=h.ToolTipActive()):ab(h.ToolTip())||(i=h.ToolTip()),0==b.children(".hdtb-text").length&&(d&&(j=c&&null!=h.ActiveHotBitmapImage()?h.ActiveHotBitmapImage():h.ActiveBitmapImage()),null==j&&(j=c&&null!=h.NormalHotBitmapImage?h.NormalHotBitmapImage:h.NormalBitmapImage),f=b.children("div"),f.hasClass("hdtb-"+j)||f.removeClass().addClass("hd-img hdtb-"+j),(h.IsCustom||0!=j.indexOf(h.ID))&&(f.removeClass("hdtb-"+h.ID).height(20).css({"background-image":"url("+j+")","background-size":"auto",width:"auto"}),f.children().length>0?f.children().attr("src",j):a('<img src="'+j+'" style="visibility:hidden"></img>').appendTo(f))),b.toggleClass(gb,c),null!=i&&(null==db(b)||db(b)!=i)&&cb(b,i),g.resolve()}var f,g=a.Deferred(),h=b.Tag,i=null,j=null;return h.IsHot=c,"boolean"!=typeof d&&(h.IsToggleButton()?h.IsActive().then(e):d=!1),"boolean"==typeof d&&e(d),g}function O(a,b){this._outlineControl.OutlineControl("Update",0!=(b.UpdateFlags&k.OutlineRelated)?this._interview.Root():null,b.CurrentNodeChanged&&null!=W.CurrentOutlineNode()?W.CurrentOutlineNode()._id:-1)}function P(a,b){var c,d=this._interview.FindDialogByID(b.NodeID,!1);null!=d&&(c={s:null},this._interview.GotoDialog(d,c,!1,!0,function(a,b){a||W.Alert(b)}))}function Q(a){9==a.which&&!a.shiftKey&&(this.OutlineDialogSplitter.focus(),a.preventDefault())}function R(a){this._addCustomToolbarButton=a,this.RegisterToolbarButton=function(a,b,c,d,e,f,g,h,i,j){return this._addCustomToolbarButton(a,b,c,d,e,f,g,h,i,j)}}function S(a){this._defineCustomNavigationbarButton=a,this.RegisterNavigationbarButton=function(a,b,c,d,e,f,g,h,i){return this._defineCustomNavigationbarButton(a,b,c,d,e,f,g,h,i)}}function T(c,d,e,f,g,i,j,k,l,n,o){if(null==d)throw new h("clickEnabledDel");if(null==e)throw new h("clickedDel");var p=this.IsCustom=null==c||""==c;this.ID=p?b.Guid.NewGuid():c,p&&null!=f&&f.indexOf("/")<0&&f.indexOf("\\")<0&&(this.IsCustom=p=!1),this._clickEnabledDel=d,this._clickedDel=e,null!=f&&""!=f&&(this.NormalBitmapImage=U(f,p)),null!=g&&""!=g&&(this.NormalHotBitmapImage=U(g,p)),this._toolTip=j,null!=k&&(this._activeDel=k,null!=l&&""!=l&&(this._activeBitmapImage=U(l,p)),null!=n&&""!=n&&(this._activeHotBitmapImage=U(n,p)),this._toolTipActive=o),this.StatusText=i,this.SetImages=function(a,b,c,d){var e=this.IsCustom;this.NormalBitmapImage=ab(a)?null:U(a,e),this.NormalHotBitmapImage=ab(b)?null:U(b,e),null!=this._activeDel&&(this._activeBitmapImage=ab(c)?null:U(c,e),this._activeHotBitmapImage=ab(d)?null:U(d,e))},this.OnClick=function(){this._clickEnabledDel()&&(this._clickedDel.call(this,this.ID),this._updateDel&&this._updateDel())},this.ToolTip=function(){return this._toolTip},this.IsToggleButton=function(){return null!=this._activeDel},this.IsActive=function(){var b=a.Deferred();return null!=this._activeDel?this._activeDel.call(this,this.ID,function(a){b.resolve(a)
}):b.resolve(!1),b},this.ActiveBitmapImage=function(a){return a===m?this._activeBitmapImage:(this._activeBitmapImage=a,void 0)},this.ActiveHotBitmapImage=function(a){return a===m?this._activeHotBitmapImage:(this._activeHotBitmapImage=a,void 0)},this.ToolTipActive=function(){return this._toolTipActive}}function U(a){return a}function V(a,b,c,d){var e=this;e.imageNormal=a,e.imageHot=b,e.imageActive=c,e.imageActiveHot=d}var W=HOTDOC$;this.DEBUG===m&&(this.DEBUG=W.DEBUG);var X,Y,Z,$=a.proxy,_=b.Windows.Visibility,ab=b.String.IsNullOrEmpty,bb=b.Windows.Controls.ToolTipService,cb=bb.SetToolTip,db=bb.GetToolTip,eb="hd-OutlineControl",fb="GetResourceString",gb="hdtb-hot",hb="hd-titlebar-buttons",ib="btndp",jb="btnas",kb="btnsv",lb="btnol",mb="btnod",nb="btnpg",ob="btnrs",pb="btnhp";return a.widget("hd.InterviewControl",{_create:function(){X=a.Widget.prototype;var b,c,d,e,f,g,h=this,i=h.options.engine,j="boolean"!=typeof HDIconVisible||HDIconVisible,k=W.Lc.GetStr("ui_logo");h.element.css("height","100%"),a(document).on("keydown",$(this.OnKeyDown,this)),h.Toolbar=a('<div id="hdHeading"/>').appendTo(h.element),h.Titlebar=a('<div class="hd-titlebar"/>').appendTo(h.Toolbar),h.ToolbarButtons=a("<div/>").addClass(hb).appendTo(h.Titlebar),h.ToolbarMenu=a("<div/>").addClass(hb).appendTo(h.Titlebar),g=null,e=a('<div><div class="hdtb-text">'+W.Lc.GetStr("tb_mnu")+"</div></div>").appendTo(h.ToolbarMenu).hover(function(){a(this).toggleClass(gb)}).addClass("hdtb-icon").click($(function(){var b=[];null==g&&(g=a("<div/>").Popup({anchor:e,anchorPos:"b",open:function(b){var c=20,d=b.element.find(".hd-img"),e=0;d.each(function(){c=Math.max(c,a(this).width())}),d.each(function(){var b=a(this);b.css("margin-left",5+(c-b.width()))}),b.element.find(".hd-menu-iconbkgrd").width(c+20),b.element.find(".hd-menu-caption").css("padding-left",c+25),b.element.find(".hd-menu-item").css("width","auto").each(function(){e=Math.max(e,a(this).outerWidth())}),b.element.find(".hd-menu-item").css("width",.98*e),b.element.find(".hd-menu-base").width(e)}}).css("width","auto"),f=a("<div/>").appendTo(g).Menu().on("ItemSelected",$(function(a,c){g.Popup("close"),b[c].Tag.OnClick()},this))),f.empty();var c=this.Toolbar.Children;return this.ToolbarButtons.children().each(function(){var d,e,g,h,i=a(this);if("none"!=i.css("display"))for(e=i.attr("title"),g=i.children().hasClass("hdtb-text")?i.text():e,h=a("<div/>").attr("title",e).appendTo(f).MenuItem({Label:g,Tag:b.length,IsEnabled:!0}),i.children().hasClass("hdtb-text")||h.find(".hd-menu-icon").replaceWith(i.children().clone().addClass("hd-menu-icon").css("float","left")),d=0;d<c.length;d++)if(i[0]==c[d][0]){b.push(c[d]);break}}),g.Popup("open"),!1},this)).attr({title:W.Lc.GetStr("tb_mnu_tip")}),d=a('<div class="hdtb-icon"><div class="hdtb-text">5</div></div>').hide().appendTo(h.ToolbarButtons),Y=d.outerHeight(),Z=Math.max(0,(Y-22)/2)+"px",d.remove(),c=a('<div><div class="hd-img hdtb-logo"/></div>').addClass("hd-titlebar-icon hdtb-icon").attr({alt:k,title:k,Name:"HDIcon"}).css({display:j?"inline":"none",padding:Z}).height(Y).appendTo(h.Titlebar),h.TemplateTitle=a("<div/>").addClass("hd-titlebar-title").attr({valign:"baseline",title:j?"":W.Lc.GetStr("ui_logo")}).css("line-height",Y+"px").height(Y).appendTo(h.Titlebar),h.Toolbar.Children=[c,h.TemplateTitle],h.Interview=a('<table id="hdBodyDiv" style="table-layout:fixed; width:100%;" cellspacing="0"><tbody><tr id="hdBodyRow"></tbody></table>').appendTo(h.element),h.leftBar=a('<td><table cellspacing=0 style="table-layout:fixed; width:100%;height:100%;"><tr id="RealOutlineContainer"/></table></td>').hide().appendTo(h.Interview.find("#hdBodyRow")).SideBar({side:"left",icon:"hdtb-btnol",tip:[W.Lc.GetStr("tb_ol1"),W.Lc.GetStr("tb_ol0")],title:W.Lc.GetStr("ui_io")}),h.OutlineDialogSplitter=a("<td/>").appendTo(h.Interview.find("#hdBodyRow")).GridSplitter({type:"v",target:"#hdOutlineDiv"}),B.call(this),a(i).on("ChangeUIState",i,$(h._engine_ChangeUIState,h)),h._interview=h.options.interview,a(h._interview).on("RefreshDialogContent",$(h._interview_RefreshDialogContent,h)).on("Closing",function(){W.Dialog.InterviewStack.PopInterview()}),h._dialogControl=a('<td id="hdInterviewDiv"/>').DialogControl({interview:h._interview}),h._dialogControl.TabIndex=3,h._dialogControl.focuslv=!0,h._dialogControl.on("FocusLeaving",$(this._dialogControl_FocusLeaving,h)),h._dialogControl.appendTo(h.Interview.find("#hdBodyRow")),h.rightBar=a("<td/>").appendTo(h.Interview.find("#hdBodyRow"));var l=a("<div/>").appendTo(this.rightBar).addClass("hd-float-title-bar");a("<div/>").appendTo(l).addClass("hd-float-title").text(W.Lc.GetStr("rs_bcap"));var m=a("<div/>").addClass("hd-float-title-buttons").appendTo(l);a("<div/>").appendTo(m).addClass("hd-img hd-dock-rp").attr("title","Dock resource pane to bottom of interview").click($(v,this)),a("<div/>").appendTo(m).addClass("hd-img hd-closex").attr("title",W.Lc.GetStr("tb_rs0")),a("<div/>").addClass("sliding-resource-pane").insertAfter(l),h.rightBar.SideBar({side:"right",icon:"hdtb-btnrs",tip:[W.Lc.GetStr("tb_rs1"),W.Lc.GetStr("tb_rs0")],title:W.Lc.GetStr("rs_bcap")}).SideBar("Show"),a("<div/>").prependTo("#hdResourcePane").css("float","right").addClass("hd-img hd-closex").attr("title",W.Lc.GetStr("tb_rs0")).click($(v,this)),0==h.Interview.closest("form").length&&(b=a('<form name="hdForm" action="'+a("#hdMainDiv").HDInterview("option","blankFrame")+'" method="post"/>').appendTo(h.Interview.parent()),h.Interview.appendTo(b)),W.Dialog.InterviewStack.PushInterview(h),h.OutlineDialogSplitter.on("keydown",$(h.OutlineDialogSplitter_KeyDown,h)),h._interviewInitialized=!1,h._outlineImageIndex=-1,h._dropdownImageIndex=-1,cb(c,h._interview[fb]("ui_logo")),h._hiddenToolbarButtons={},h._reassertFocus=!1,h._navigationBarMinWidth=0,h._navigationButtonMinHeight=0},_setOption:function(b,c){switch(a.Widget.prototype._setOption.apply(this,arguments),b){case"height":var d=c-("block"==this.Toolbar.css("display")?this.Toolbar.outerHeight(!0):0),e=this._dialogControl.children(".hd-dlg-content"),f=0;this.Interview.height(d),this._outlineControl&&this._outlineControl.OutlineControl({height:d}),a(".hd-sidebar").height(d),a(".sliding-resource-pane").outerHeight(d-a(".hd-float-title-bar").outerHeight()),e.siblings().each(function(){var b=a(this);"none"!==b.css("display")&&(f+=b.outerHeight(!0))}),e.height(d-f).trigger("LayoutUpdated");break;case"width":this.element.resize();break;case"tbMenu":c&&(this.ToolbarButtons.hide(),this.ToolbarMenu.show())}},_engine_ChangeUIState:function(b,c){if(!this._interviewInitialized&&c.State==W.UIState.Ready){var e,f,g=b.data,h=this,i=HDAPI;h.Title(l.HDEscQuots(g.TemplateTitle(),!0,!0)),g.DocPreviewEnabled&&L.call(h,ib,$(r,h),g[fb]("tb_dpt"),g[fb]("tb_dp"),null,null),g.AnswerSummaryEnabled&&L.call(h,jb,$(s,h),g[fb]("tb_ast"),g[fb]("tb_as"),null,null),ab(g.SaveAnswersUrl)||L.call(h,kb,t,g[fb]("tb_svt"),g[fb]("tb_sv"),null,null),g.PreferenceCache().HideInterviewOutline()?h.OutlineVisibility(_.Collapsed):(h._outlineControl=a("<td/>").prependTo(a("#hdBodyRow")).OutlineControl().on("NodeSelected",$(P,h)).on("keydown",$(Q,h)),g.InterviewOutlineInitialWidth>0&&h._outlineControl.width(g.InterviewOutlineInitialWidth),a(h._interview).on("RefreshOutline",$(O,h)),h._interview.refrshevt=!0,h._interview.PreferenceCache().OutlineVisibleMod()?(h._outlineControl.data(eb).CloseImage.on("click",$(n,h)),h._outlineControl.data(eb).PinImage.on("click",$(o,h))):g.PreferenceCache().OutlineVisibleInitially()?h._outlineControl.data(eb).CloseImage.hide():(h._outlineControl.data(eb).PinImage.hide(),h._outlineControl.data(eb).CloseImage.show()),h.element.on("resize",$(h.InterviewControl_SizeChanged,h)),h.OutlineVisibility(g.PreferenceCache().OutlineVisibleInitially()?_.Visible:_.Collapsed)),g.PreferenceCache().SinglePageMod()&&L.call(h,nb,$(w,h),g[fb]("tb_pgt"),g[fb]("tb_pg1"),$(u,h),g[fb]("tb_pg0")),h._dialogControl.DialogControl({ResourcePaneVisibility:g.PreferenceCache().ResourcePaneVisibleInitially()?_.Visible:_.Collapsed}),e=g[fb]("ui_helpcaption"),(null==e||""==e)&&(e="Help"),f=M.call(this,pb,x,g[fb]("tb_hlp"),g[fb]("ui_help"),null,null,e,-1),i._enumCustTBBtns(new R($(E,h))),i._enumCustNBBtns(new S($(h.DefineCustomNavigationbarButton,h))),h._dialogControl.DialogControl("ApplyCustomNavigationbarButtonDefinitions",d.ButtonDefinitions()),h._interviewInitialized=!0}},_interview_RefreshDialogContent:function(a){var b,c,d;if(this.rightBar.SideBar("Slide",a,0,!1),this.leftBar.SideBar("Slide",a,0,!1),this._customActiveStateToolbarButtons!==m){for(d=0;d<this._customActiveStateToolbarButtons.length;d++)c=this._customActiveStateToolbarButtons[d],b=c.Tag,N.call(this,c,b.IsHot,null);this.element.resize()}},_dialogControl_FocusLeaving:function(){},OnKeyDown:function(a){var b=W.Dialog.NavigateOperation,c=null;switch(a.which){case 33:a.ctrlKey||a.altKey?a.ctrlKey&&(c=b.PreviousUnanswered):c=b.Previous;break;case 34:a.ctrlKey||a.altKey?a.ctrlKey&&(c=b.NextUnanswered):c=b.Next;break;case 36:a.ctrlKey&&this._interview.IsFirstEnabled()&&(c=b.First);break;case 35:a.ctrlKey&&(c=b.Last);break;default:a.altKey&&(c=this._dialogControl.DialogControl("option","AccessKeys")[a.which],c&&(c.trigger("click"),a.Handled=!0))}"number"==typeof c&&(a.Handled=this._dialogControl.DialogControl("DoNavigation",c)),a.Handled&&a.stopPropagation()},Title:function(a){return"string"!=typeof a?this.TemplateTitle.text():(this.TemplateTitle.html(""==W.Trm(a)?"&nbsp;":a),this.element.resize(),void 0)},ScriptLinkDialogElementName:function(){return null},ComputationVariableName:function(){return null},DialogControl:function(){return this._dialogControl},CloseInterview:function(){},SetToolbarButtonImage:function(b,c,d,e,f){var g,h;g=ab(b)||"HDOutlineDropDown"!=b?C(b):mb,ab(g)||(h=this._buttonImageNames[g],h!==m&&(h.imageNormal=c,h.imageHot=d,h.imageActive=e,h.imageActiveHot=f),a.each(this.Toolbar.Children,function(b,h){var i,j,k;if(null!=h&&null!=h.Tag){if(i=h.Tag,null!=i&&i.ID==g)return i.SetImages(c,d,e,f),N(h,i.IsHot,null),!1}else if(null!=h&&h.attr("Name")==g)return j=U(c,!0),k=h.children().removeClass("hdtb-logo").height(20).css({"background-image":"url("+j+")","background-size":"auto",width:"auto"}),k.children().length>0?k.children().attr("src",j):a('<img src="'+j+'" style="visibility:hidden"></img>').appendTo(k),!1}))},DefineCustomNavigationbarButton:function(a,b,e,f,g,h,i,j,k){var l=new c(y(a),b,e,f,g,z(h),i,A(j),k);return d.AddButtonDefinition(l),l.ID},SetToolbarButtonVisible:function(a,b){var c,d,e,f=C(a);if(!ab(f)){for(c=0;c<this.Toolbar.Children.length;c++)if(d=this.Toolbar.Children[c],null!=d&&null!=d.Tag){if(e=d.Tag,null!=e&&e.ID==f)return b?d.show():d.hide(),this.element.resize(),void 0}else if(null!=d&&d.attr("Name")==f)return d[b?"show":"hide"](),cb(this.TemplateTitle,b?null:this._interview[fb]("ui_logo")),this.element.resize(),void 0;b?this._hiddenToolbarButtons!==m&&this._hiddenToolbarButtons[f]!==m&&delete this._hiddenToolbarButtons[f]:(this._hiddenToolbarButtons===m&&(this._hiddenToolbarButtons={}),this._hiddenToolbarButtons[f]=!0)}},IsToolbarButtonEnabled:function(b){var c,d,e=!1;return W.Dialog.DialogControl.MayInvokeButton()&&!W.Dialog.InterviewStack.InPopupInterview()&&(c=C(b),ab(c)||a(this.Toolbar.Children).each(function(a,b){return null!=b&&null!=b.Tag&&b.Visibility==_.Visible&&(d=b.Tag,null!=d&&d.ID==c)?(e=!0,!1):void 0})),e},InvokeToolbarButton:function(b){if(W.Dialog.DialogControl.MayInvokeButton()&&!W.Dialog.InterviewStack.InPopupInterview()){var c,d=C(b);ab(d)||a(this.Toolbar.Children).each(function(a,b){return null!=b&&null!=b.Tag&&(c=b.Tag,null!=c&&c.ID==d)?(c.OnClick(),!1):void 0})}},OutlineVisibility:function(b){return b===m?this._outlineVisibility:(b!=this._outlineVisibility&&(b==_.Visible?(this._outlineControl.css("width",this.dw+"px"),this.leftBar.SideBar("Hide"),this._outlineControl.data(eb).PinImage.hide(),this.OutlineDialogSplitter.show(),this._outlineControl.prependTo(a("#hdBodyRow")).show().width(Math.min(this._outlineControl.width(),this.Interview.width()/2)).find("#hdOutlineTree").css({"max-height":"100%","margin-bottom":"auto"}).height(this.Interview.height()-a("#hdOutlineTitle").outerHeight()),a("#hdOutlineContent").css("width","auto")):(this._outlineControl!=m&&this._outlineControl.hide(),this.OutlineDialogSplitter.hide(),this._outlineControl.appendTo(a("#RealOutlineContainer")).show(),this._interview.PreferenceCache().OutlineVisibleMod()&&this._outlineControl.data(eb).PinImage.show(),this.dw=parseInt(this._outlineControl[0].style.width),this._outlineControl.css("width","auto"),this.leftBar.SideBar("Show")),a("#hdInterviewDiv").css("width",b==_.Visible?"auto":"100%"),this._outlineVisibility=b,this.element.resize()),void 0)},_outlineControl_NodeExpanded:function(){},InterviewControl_SizeChanged:function(){this.element.find(".hd-grid").triggerHandler("LayoutUpdated"),"block"==this.Toolbar.css("display")&&(this.ToolbarButtons.show(),this.ToolbarMenu.hide(),this._setOption("tbMenu",this.Toolbar[0].clientHeight<this.Toolbar[0].scrollHeight))},OutlineDialogSplitter_KeyDown:function(a){null!=this._outlineControl&&9==a.which&&a.shiftKey&&(this._outlineControl.focus(),a.Handled=!0)}}),W.Interview.StatusTextEventArgs=function(a){this.StatusText=a},a.hd.InterviewControl}),define("interview/page",["hdmain/jq","hdmain/system","interview/interviewcontrol"],function(a,b,c,d){var e=HOTDOC$;this.DEBUG===d&&(this.DEBUG=e.DEBUG);var f=a.proxy;return a.widget("hd.Page",{_create:function(){this._app=e.HDEngine,this.element.on("Loaded",f(this.Page_Loaded,this))},interviewControl:function(){return this._interviewControl},Page_Loaded:function(){this.element.off("Loaded"),this._interviewControl=a("<div/>").appendTo(this.element).InterviewControl({engine:this._app._engine,interview:e.CurrentInterview()}).on("StatusTextChanged",f(this.interviewControl_StatusTextChanged,this)),!1},LayoutRoot_LostFocus:function(){},LayoutRoot_GotFocus:function(){},interviewControl_StatusTextChanged:function(a,b){this._app.BrowserStatusBar(b.StatusText)}}),a.hd.Page}),define("dialog/builtinnavigationbarbuttonstate",["hdmain/system"],function(a,b){function c(a){this.ImageName(a),this.IsImageDefault=!0,this.Visible=!0}return a.ExtendClass(c,null,{ImageName:function(a){return a===b?this._imageName:(a!=this._imageName&&(this._imageName=a,this.IsImageDefault=!1),void 0)}}),c}),define("engine/pairedcode",[],{b:0,i:1,st:2,un:3,sc:4,fs:5,ac:6,lc:7,h:8,p:9,wl:10}),define("engine/htmlformatter",["hdmain/system","engine/pairedcode"],function(a,b){function c(a){this._text=a}function d(a){var b=a.substr(11);return b.indexOf("+")>=0&&(b=/%\d{2}?/.test(b)?/\x20|%20/.test(b)?b.replace("+","%2B"):b.replace(/\+/g,"%20"):b.replace(/\+/g,"%2B")),b=b.replace(/\x27/g,"%27").replace(/\x22/g,"%22"),b=b.replace(/\&#39;/g,"%27").replace(/\&quot;/g,"%22"),"javascript:"+b}function e(a,b){var d=c.MakeAbsoluteUrl(a,!0);return 0==d.indexOf("javascript:")?"HDAPI._DoWebLinkAction('"+d+"')":(a=d.replace(/\x27/g,"\\'"),"window.open('"+a+"', '_blank'"+(f(b)?"":", '"+b+"'")+")")}var f=a.String.IsNullOrEmpty;return a.ExtendClass(c,null,{PreParse:function(){},PostParse:function(){},WriteText:function(a,c){var d,e="";a.IsCodeEnabled(b.b)&&(e+="font-weight:bold; "),a.IsCodeEnabled(b.i)&&(e+="font-style:italic; "),a.IsCodeEnabled(b.st)&&(e+="text-decoration:line-through; "),a.IsCodeEnabled(b.un)&&(e+="text-decoration:underline; "),a.IsCodeEnabled(b.sc)&&(e+="font-variant:small-caps; "),a.IsCodeEnabled(b.fs)&&(d=a.ChangeFontSize(100),e+="font-size:"+d.toString()+"%; "),e.length>0&&(this._text.Append('<span style="'),this._text.Append(e),this._text.Append('">'));for(var f=0;f<c.length&&" "==c[f];f++)c=c.substr(0,f)+"&#160;"+c.substr(f+1),f+=5;c=c.replace("	","&#160;&#160;&#160;&#160;"),this._text.Append(c),e.length>0&&this._text.Append("</span>")},WriteLineBreak:function(){this._text.Append("<br/>")},WriteWebLink:function(a,b,c){this._text.Append('<a href="#" class="dot-w" '),this._text.Append('onclick="javascript:'),this._text.Append(e(b,null)),this._text.Append('">'),this.WriteText(a,c),this._text.Append("</a>")}},{MakeAbsoluteUrl:function(a,b){0==a.toLowerCase().indexOf("javascript:")&&(a=d(a));var c,e,g=a;return/^\w+:/.test(g)?g:(e=b&&"string"==typeof HDBaseURLForLinks?HDBaseURLForLinks:null,c=f(e)?"":e,c+g)}}),c}),define("dialog/navigationuistate",["dialog/builtinnavigationbarbuttonstate","engine/htmlformatter"],function(a,b,c){var d=HOTDOC$;this.DEBUG===c&&(this.DEBUG=d.DEBUG);var e,f={FirstButtonName:"First",PreviousUnansweredButtonName:"PreviousUnanswered",PreviousButtonName:"Previous",NextButtonName:"Next",NextUnansweredButtonName:"NextUnanswered",LastButtonName:"Last",FinishButtonName:"Finish",FinishPopupButtonName:"FinishPopup",SetDefaultButton:function(b,c){e[b]=new a(c)},IsValidBuiltInButtonInternalName:function(a){switch(a){case this.FirstButtonName:case this.PreviousUnansweredButtonName:case this.PreviousButtonName:case this.NextButtonName:case this.NextUnansweredButtonName:case this.LastButtonName:case this.FinishButtonName:case this.FinishPopupButtonName:return!0}return!1},GetBuiltInButtonInternalName:function(a){switch(a){case"HDFirstPage":return this.FirstButtonName;case"HDPrevUnans":return this.PreviousUnansweredButtonName;case"HDPrevPage":return this.PreviousButtonName;case"HDNextPage":return this.NextButtonName;case"HDNextUnans":return this.NextUnansweredButtonName;case"HDLastPage":return this.LastButtonName;case"HDFinish":return this.FinishButtonName;case"HDFinishPopup":return this.FinishPopupButtonName;default:return""}},SetBuiltInButtonVisible:function(a,b){e[a].Visible=b},GetBuiltInButtonVisible:function(a){var b=e[a];return b!==c?b.Visible:!1},IsBuiltInButtonUsingDefaultImage:function(a){var b=e[a];return b!==c?b.IsImageDefault:!1},SetBuiltInButtonImage:function(a,b){e[a].ImageName(b)},GetBuiltInButtonImage:function(a){var b=e[a];return b!==c?b.ImageName():""},MakeBuiltInButtonImageUri:function(a){var d=e[a];return d!==c?d.IsImageDefault?d.ImageName():b.MakeAbsoluteUrl(d.ImageName(),!1):null}};return f.NavigationbarVisible=!0,e={},f.SetDefaultButton(f.FirstButtonName,"hd-nav-First"),f.SetDefaultButton(f.PreviousUnansweredButtonName,"hd-nav-PrevU"),f.SetDefaultButton(f.PreviousButtonName,"hd-nav-Prev"),f.SetDefaultButton(f.NextButtonName,"hd-nav-Next"),f.SetDefaultButton(f.NextUnansweredButtonName,"hd-nav-NextU"),f.SetDefaultButton(f.LastButtonName,"hd-nav-Last"),f.SetDefaultButton(f.FinishButtonName,"hd-nav-Finish"),f.SetDefaultButton(f.FinishPopupButtonName,"hd-nav-FinishEM"),f}),define("engine/changeuistateeventargs",[],function(){function a(a,b){this.State=a,this.Message=b}return a}),define("interview/app",["hdmain/jq","hdmain/system","interview/page","dialog/navigationuistate","engine/stringparsersource","engine/htmlformatter","engine/interviewnodetype","engine/interviewnode","engine/changeuistateeventargs"],function(a,b,c,d,e,f,g,h,i,j){function k(b,c){var d=this;d._engine=new C.Engine(c.TemplatePath,c.Template,c.AssemblyName),a(d._engine.Templates).on("TemplateDownloadProgressChanged",A(d.TemplateDownloadProgressChanged)),a(d._engine).on("ChangeUIState",r).on("NavigatedJSAPI",A(t,d)).on("PreNavigateJSAPI",A(s,d)).on("InterviewComplete",A(u,d)),d.Host.resize(A(d.Content_Resized,d)),a(x).on("PopupInterviewOpened",A(d.InterviewStack_PopupInterviewOpened,d)).on("PopupInterviewClosed",A(d.InterviewStack_PopupInterviewClosed,d)),n.call(d)}function l(){}function m(a,b){r(this,new i(D.Error,"Unhandled Exception: \n"+b.ExceptionObject.ToString()))}function n(){o.call(this)}function o(){this.RootVisual=a("<div/>").Page().appendTo(this.element).trigger("Loaded")}function p(){this.option({_ansSumColumns:1,_ansSumIndentPrompts:!0,_ansSumBulletPrompts:!1,_ansSumIndentAnswers:!0,_ansSumBulletAnswers:!1,_ansSumBorders:F.None,_ansSumCol1Width:30,_ansSumCol2Width:70})}function q(a){var b={s:null},c=a.call(y(),b);!c&&!E(b.s)&&z.Alert(b.s)}function r(a,b){var c=z.HDEngine.PageStateUpdate;c!==j?c(this,new w(b.State,0,null==b.Message||""==b.Message?b.Message:b.Message.replace("\r\n","<br />"))):b.State==D.Error&&alert(b.Message)}function s(a,b,c){var d={v:null},e={v:null};v("PreHDNavigate",!0,!0,d,e,"DialogName",b.DialogName,"TargetName",b.TargetName,"Callback",function(a,d){b.Cancel=a,b.CancelMessage=d,c(b)})}function t(a,b,c){var d={v:null},e={v:null};v("OnHDNavigated",!1,!1,d,e,"DialogName",b.DialogName),E(z.QueuedBookmark())||c.GotoBookmark(z.QueuedBookmark())}function u(a,b){b.Cancel=!this.OnInterviewComplete()}function v(a,b,c){var d,e,f=-1,g=[a,b,c];for(d=5;d<arguments.length;d++)g.push(arguments[d]),"Callback"==arguments[d]&&(f=g.length,e=arguments[d+1],d++);0>f&&(g.push("Callback"),f=g.length),g[f]=function(a,b){"function"==typeof e&&e.call(this,c?a:!1,c?b:"")},HDAPI._invokeHandler.apply(this,g)}function w(a,b,c){this.State=a,this.Progress=b,this.Message=c}var x,y,z=HOTDOC$,A=a.proxy,B=b.Text.Encoding,C=(b.Environment,z.Engine),D=z.UIState,E=b.String.IsNullOrEmpty,F={None:0,Plain:1,Sculptured:2};return a.widget("hd.App",{_create:function(){x=z.Dialog.InterviewStack,y=z.CurrentInterview;var a=this,b=a.options;a.Host=a.element.on("Startup",A(k,a)).on("Exit",A(l,a)).on("UnhandledException",A(m,a)),p.call(a),a.option(b),z.HDEngine=a,a.element.trigger("Startup",{TemplatePath:b.initParams.TemplatePath,Template:b.initParams.Template}),b.onLoad(a.element[0])},_setOption:function(b,c){switch(a.Widget.prototype._setOption.apply(this,arguments),b){case"height":this.RootVisual&&this.RootVisual.children().InterviewControl({height:c}),this.options.ContentResized&&this.options.ContentResized(),this.element.trigger("Resized");break;case"width":this.RootVisual.children().InterviewControl({width:c});break;case"onError":this.element.on(b.substr(2),c)}},BrowserStatusBar:function(a){return a===j?window.status:(window.status=a,void 0)},TemplateDownloadProgressChanged:function(b,c){a(this).trigger("PageStateUpdate",new w(D.Busy,c.ProgressPercentage,z.Lc.GetStr("ui_addl")))},Content_Resized:function(){this.RootVisual!=j&&this.RootVisual.height(this.Host.outerHeight(!0))},LocaleHelper:function(){return this._localeHelper},InterviewControl:function(){return this.RootVisual.Page("interviewControl")},ToolbarHeight:function(){return this.ToolBarVisible()?this.InterviewControl().data("hd-InterviewControl").Toolbar.outerHeight(!0):0},ToolBarVisible:function(a){if(a===j)return"block"==this.InterviewControl().data("hd-InterviewControl").Toolbar.css("display");var b=this.InterviewControl(),c=b.InterviewControl("option","height");b.data("hd-InterviewControl").Toolbar.css("display",a?"block":"none"),b.InterviewControl({height:c})},NavigationBarVisible:function(a){if(a===j)return d.NavigationbarVisible;if(a!=d.NavigationbarVisible){d.NavigationbarVisible=a,x.Depth()>0&&x.CurrentInterview().DialogControl().DialogControl("Navigationbar")[a?"show":"hide"]();var b=this.InterviewControl();b.InterviewControl({height:b.InterviewControl("option","height")})}},SetToolbarButtonImage:function(a,b,c,d,e){this.InterviewControl().InterviewControl("SetToolbarButtonImage",a,b,c,d,e)},SetNavigationbarButtonImage:function(a,b){var c=d.GetBuiltInButtonInternalName(a);E(c)||d.SetBuiltInButtonImage(c,b),x.Depth()>0&&x.CurrentInterview().DialogControl().DialogControl("SetNavigationbarButtonImage",a,b)},SetButtonVisible:function(a,b){var c=d.GetBuiltInButtonInternalName(a);E(c)||d.SetBuiltInButtonVisible(c,b),x.Depth()>0&&!x.CurrentInterview().DialogControl().DialogControl("SetNavigationbarButtonVisible",a,b)&&this.InterviewControl().InterviewControl("SetToolbarButtonVisible",a,b)},IsButtonEnabled:function(a){return z.Dialog.InterviewStack.Depth()>0&&z.Dialog.InterviewStack.CurrentInterview().DialogControl().IsNavigationbarButtonEnabled(a)||this.InterviewControl().IsToolbarButtonEnabled(a)},InvokeButton:function(a){x.Depth()>0&&!x.CurrentInterview().DialogControl().DialogControl("InvokeNavigationbarButton",a)&&this.InterviewControl().InterviewControl("InvokeToolbarButton",a)},InPopupInterview:function(){return x.InPopupInterview()},ClosePopupInterview:function(){x.InPopupInterview()&&x.CurrentInterview().CloseInterview()},InterviewStack_PopupInterviewOpened:function(b,c){a(this).trigger("PopupInterviewOpened",c)},InterviewStack_PopupInterviewClosed:function(b,c){a(this).trigger("PopupInterviewClosed",c)},TemplateTitle:function(a){var b=this._engine;return"string"!=typeof a?b.TemplateTitle():(b.TemplateTitle(a),null!=this.InterviewControl()&&this.InterviewControl().InterviewControl("Title",a),void 0)},DocPreviewEnabled:function(a){var b=this._engine;return a===j?b.DocPreviewEnabled:(b.DocPreviewEnabled=a,void 0)},AnswerSummaryEnabled:function(a){var b=this._engine;return a===j?b.AnswerSummaryEnabled:(b.AnswerSummaryEnabled=a,void 0)},ProgressBarEnabled:function(a){var b=this._engine;return a===j?b.ProgressBarEnabled:(x.CurrentInterview().DialogControl().DialogControl({ProgressBarEnabled:a}),b.ProgressBarEnabled=a,void 0)},SaveAnswersUrl:function(a){var b=this._engine;return a===j?b.SaveAnswersUrl:(b.SaveAnswersUrl=a,void 0)},ShowAllResourceButtons:function(a){var b=this._engine;return a===j?b.ShowAllResourceButtons:(b.ShowAllResourceButtons=a,void 0)},ResourcePaneInitialHeight:function(a){return a===j?z.ResourcePaneInitialHeight:(z.ResourcePaneInitialHeight=a,void 0)},InterviewOutlineInitialWidth:function(a){var b=this._engine;return"number"!=typeof a?b.InterviewOutlineInitialWidth:(b.InterviewOutlineInitialWidth=a>0?a:200,void 0)},GetStr:function(a){return z.Lc.GetStr(a)},Trace:function(){},ClearFocus:function(){y().ClearFocusItem()},SetRequiredAsterisk:function(a){z.RequiredAsterisk=a},SetDisableFinishWarning:function(a){z.DisableFinishWarning=a},SetAnswerDTD:function(a){null!=a&&z.SetAnswerDTD(a)},SetTemplateImageUrl:function(a){this._engine.InterviewImageUrl(a)},SetTestMode:function(a){this._engine.TestMode(a)},SetNextFollowsOutline:function(a){this._engine.NextFollowsOutline=a},SetUnansweredText:function(a){this._engine.DefaultUnansweredText(a)},SetAnswerSummaryPrefs:function(a,b,c,d,e,f,g){var h=this.options;this.option({_ansSumColumns:1==a?1:2,_ansSumIndentPrompts:b,_ansSumBulletPrompts:c,_ansSumIndentAnswers:d,_ansSumBulletAnswers:e,_ansSumBorders:"P"==f?F.Plain:"S"==f?F.Sculptured:F.None,_ansSumCol1Width:10>g||g>90?30:g}),h._ansSumCol2Width=100-h._ansSumCol1Width,2==h._ansSumColumns&&this.option({_ansSumIndentPrompts:!1,_ansSumBulletPrompts:!1,_ansSumIndentAnswers:!1,_ansSumBulletAnswers:!1})},InterviewVersion:function(){return"6.7.0.0"},InBulkAnswerUpdate:function(){return this._engine.InBulkAnswerChange()},BeginBulkAnswerUpdate:function(){this._engine.BeginBulkAnswerChange()},EndBulkAnswerUpdate:function(a){"boolean"!=typeof a&&(a=!0),this._engine.EndBulkAnswerChange(a)},GetValType:function(a){switch(this._engine.GetValueType(a)){case"TX":return"TX";case"TF":return"TF";case"NU":return"NU";case"DA":return"DA";case"MC":return"MC"}return null},ValuesAdded:function(){this._engine.AnswerLoadingComplete()},ClearAnswers:function(){z.ClearAnswers()},SetValue:function(a,b,c,d){this.AddValue(a,b,c,d,!1,!0,!0)},AddValue:function(a,b,c,d,e,f,g,h){c===j&&(c=null),d===j&&(d=null),"boolean"!=typeof e&&(e=!1),"boolean"!=typeof f&&(f=!1),"boolean"!=typeof g&&(g=!0),"boolean"!=typeof h&&(h=!0);var i,k,l,m,n,o,p,q=null,r=this,s=r._engine;switch(null!=c&&(q=c),a){case"TX":s.SetValueType(b,"TX",e),null!=d?(i=d.replace(/<br\s*\/?>/gi,"\r\n"),s.LoadAnswerValue("TX",b,i,!0,g,h,q)):g&&h?f&&s.ClearAnswer(b,q):s.LoadAnswerValue("TX",b,null,!0,g,h,q);break;case"NU":s.SetValueType(b,"NU",e),null!=d?s.LoadAnswerValue("NU",b,d,!0,g,h,q):g&&h?f&&s.ClearAnswer(b,q):s.LoadAnswerValue("NU",b,null,!0,g,h,q);break;case"TF":s.SetValueType(b,"TF",e),null!=d?s.LoadAnswerValue("TF",b,d,!0,g,h,q):g&&h?f&&s.ClearAnswer(b,q):s.LoadAnswerValue("TF",b,null,!0,g,h,q);break;case"DA":s.SetValueType(b,"DA",e),null!=d&&(k=null,d instanceof Date?k=d:"string"==typeof d&&(l=d,m=l.split(" "),3==m.length&&(n=parseInt(m[0]),o=parseInt(m[1])-1,p=parseInt(m[2]),k=new Date(p,o,n),isFinite(k)||(k=null)))),null!=k?s.LoadAnswerValue("DA",b,k,!0,g,h,q):g&&h?f&&s.ClearAnswer(b,q):s.LoadAnswerValue("DA",b,null,!0,g,h,q);break;case"MC":s.SetValueType(b,"MC",e),null!=d?(l=d.replace(/\2/g,"|").split("|"),s.LoadAnswerValue("MC",b,l,!0,g,h,q)):g&&h?f&&s.ClearAnswer(b,q):s.LoadAnswerValue("MC",b,null,!0,g,h,q)}},GetValue:function(a,b){var c=null,d=this._engine;switch(null!=b&&(c=b),d.GetValueType(a)){case"TX":return d.GetAnswerValue(a,c);case"NU":return d.GetAnswerValue(a,c);case"TF":return d.GetAnswerValue(a,c);case"DA":return d.GetAnswerValue(a,c);case"MC":return d.GetAnswerValue(a,c)}return null},GetProgress:function(){return z.CurrentInterview().Progress()},GetXMLAnswers:function(){return this._engine.DoAnswerSync(),z.GetXMLAnswers(!1)},GetEncodedAnswers:function(){this._engine.DoAnswerSync();var a,c=z.GetXMLAnswers(!0),d="string"==typeof HDAnswerState?HDAnswerState:null;return d?(a=z.Base64.encode(c,B.UTF8,!0),c=b.String.Format("[HDSANS({0},{1})]{2}|{3}",a.length.toString(),d.length.toString(),a,d)):c=z.Base64.encode(c,B.UTF16LE,!0),c},EncodeString:function(a,b,c){null==b&&(b="");var d;switch(b.toUpperCase()){case"UTF-16":case"UTF-16LE":d=B.UTF16LE;break;case"UTF-16BE":d=B.UTF16BE;break;default:d=B.UTF8}return c&&(a=String.fromCharCode(65279)+a),z.Base64.encode(a,d,c)},GotoNext:function(){q(y().GotoNext)},GotoPrev:function(){q(y().GotoPrev)},GotoNextUnans:function(){q(y().GotoNextUnans)},GotoPrevUnans:function(){q(y().GotoPrevUnans)},GotoFirst:function(){q(y().GotoFirst)},GotoLast:function(){q(y().GotoLast)},Finish:function(){q(y().Finish)},OnInterviewComplete:function(){if(this.InterviewComplete!==j){var a={Cancel:!1};return this.InterviewComplete(this,a),!a.Cancel}return!0},Confirm:function(a){return window.confirm(a)},GetAnswerSummary:function(){this._engine.DoAnswerSync();var a="<br><b>"+z.Lc.GetStr("ui_astitle")+"</b>"+this._engine.TemplateTitle()+this.GetAnsSumHtml(y().Root());return a},GetAnsSumHtml_ChildVars:function(a,b){var c,d,e="",f=a.IsSpreadsheetRow();for(c=0;c<a._itemNodes.Count();c++)d=!0,d=a.IsSpreadsheetRow()?a._parent.Children().get(0)._itemNodes.get(c).Visible():a._itemNodes.get(c).Visible(),d&&(e+=this.GetAnsSumHtml_Var(a._itemNodes.get(c),0,f,b));return e},CheckForDotCodes:function(a){var c=new b.Text.StringBuilder;return this._engine.DotCodeParser().Parse(new e(a),new f(c),!0),c.ToString()},GetAnsSumHtml:function(a){var c,d,e,f;if(a.Type()==g.Iteration&&a.New())return"";for(c=b.Cast(a,h),d="",null!=c&&z.PushTemplate(c.TemplateOfOrigin()),a.Type()==g.Repeat&&z.PsR(c._dialog.name),null!=c&&(c.Type()!=g.Repeat||b.Cast(c,z.RepeatNode).IsSpreadsheet())&&(d+=this.GetAnsSumHtml_Dlg(c)),e=0;e<a.Children().Count();e++)f=a.Children().get(e),f.IsSpreadsheetRow()||(d+=this.GetAnsSumHtml(f));return a.Type()==g.Iteration&&z.IcR(),a.Type()==g.Repeat&&z.PpR(),null!=c&&z.PopTemplate(c.TemplateOfOrigin()),d},GetAnsSumHtml_Dlg:function(a){if(!a.ShowInOutline()&&!a.IsOnParent())return"";var c,d,e=this,f=e.options,g=e.CheckForDotCodes(a.Caption()),h="<br><br><table class='HDASDlg' width=100%";if(2==f._ansSumColumns&&(f._ansSumBorders==F.Plain&&(h+=" border='1' cellspacing='0' "),f._ansSumBorders==F.Sculptured&&(h+=" border='2' ")),h+=">",h+="<tr width=100%><td class='HDASDlgTitle' colspan=2>",h+=g,h+="<br></td></tr>",c=b.Cast(a,z.RepeatNode),null!=c&&c.IsSpreadsheet())for(d=0;0==d||d<c.AnsweredIterationCount;d++)null!=c.Children().get(d)&&(h+=e.GetAnsSumHtml_ChildVars(c.Children().get(d),c.Children().get(d).Indices(),d));else h+=e.GetAnsSumHtml_ChildVars(a,a.Indices(),0);return h+="</table>"},GetAnsSumHtml_Var:function(a,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r="",s=a.DialogItem().type,t="",u="",v="",w="",x="",y=this,A=y.options,B=y._engine;if("TX"==s||"NU"==s||"DA"==s||"TF"==s||"MC"==s){switch(r+="<tr width=100%>",f=b.Cast(a.DialogItem(),z.Variable),g="_________________",h=y.CheckForDotCodes(a.Caption()),"NONE"==h&&(h=""),d&&(h+=y.HDASRptTag(e)),1==A._ansSumColumns?(A._ansSumIndentPrompts&&(u="padding-left:2.5em;",w="padding-left:2.5em;"),A._ansSumBulletPrompts&&(t+="&bull;"),A._ansSumIndentAnswers&&(w="padding-left:5.0em;"),A._ansSumBulletAnswers&&(v+="&bull;")):2==A._ansSumColumns&&(x+=" width:"+A._ansSumCol2Width+"% ",A._ansSumBorders==F.None&&(g="&nbsp;")),r+="<td class='HDASVarPrompt' style='"+u+"' >"+t+h+"</td>",r+=1==A._ansSumColumns?"</tr><tr><td class='HDASAnsValue' style='"+w+"'>":"<td class='HDASAnsValue' style='"+x+"' >",i=null!=B.GetAnswer(f.name)&&B.GetAnswer(f.name).IsAns(e),j=g,a.DialogItem().type){case"TX":i&&(j=B.GetAnswerValue(f.name,e));
break;case"DA":i&&(j=B.GetAnswerValue(f.name,e).toDateString());break;case"NU":i&&(j=z.Lc.FormatNumberDef(B.GetAnswerValue(f.name,e),f.decPl));break;case"TF":i?(k=B.GetAnswerValue(f.name,e),j="("+(k?"X":" ")+") "+z.Lc.GetStr("ui_yes")+"  ("+(k?" ":"X")+") "+z.Lc.GetStr("ui_no")):j="( ) "+z.Lc.GetStr("ui_yes")+"  ( ) "+z.Lc.GetStr("ui_no");break;case"MC":if(i)if(l=B.GetAnswerValue(f.name,e),1==l.length)m="",n=a.GetOptions(),m=n.Contains(l[0])?n.GetItem(l[0]).Prompt():l[0],E(m)||(j="(X) "+y.CheckForDotCodes(m));else if(l.length>1)for(j="",o=l.length,q=0;o>q;q++)m="",n=a.GetOptions(),m=n.Contains(l[q])?n.GetItem(l[q]).Prompt():l[q],E(m)||(j+=(A._ansSumBulletAnswers&&q>0?"&bull;":"")+"[X] "+y.CheckForDotCodes(m)+"<br>")}j=j.replace(/</gi,"&lt;").replace(/>/gi,"&gt;"),j=j.replace(/\n/gi,"<br/>"),r+=v+j+"</td></tr>"}else("TXL"==s||"HDL"==s||"SLL"==s||"WLL"==s)&&(p=y.CheckForDotCodes(a.Caption()),!E(p)&&"NONE"!=p&&(1==A._ansSumColumns?A._ansSumIndentPrompts&&(u="padding-left:2.5em;"):2==A._ansSumColumns&&(x+=" colspan='2'"),r+="<td class='HDASDlgElem' style='"+u+"'"+x+">"+p+"</td></tr>"));return r},HDASRptTag:function(a){var b,c="";for(b=0;b<a.length&&-1!=a[b];b++)c.length>0&&(c+=","),c+=a[b]+1;return c.length>0&&(c=" ["+c,c+="]"),c},GetCurrentRepeatIndex:function(){var a,b,c,d=z.CurrentOutlineNode();if(null==d)return"-1:-1:-1:-1";for(a=d.Indices(),b="",c=0;c<a.length&&-1!=a[c];c++)b.length>0&&(b+=":"),b+=a[c];return b},GetBookmark:function(){return z.GetBookmark()},GotoBookmark:function(a){z.GotoBookmark(a)}}),a.hd.App}),define("interview",["interview/app"],function(){});